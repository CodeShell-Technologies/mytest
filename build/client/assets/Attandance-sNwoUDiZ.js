import{w as Ue}from"./with-props-DF0D9zIo.js";import{r as a,j as e}from"./chunk-AYJ5UCUI-nSEPIBkT.js";import{D as be}from"./DataTable-DtyPIAGZ.js";import{C as Be}from"./CustomPagination-CBTcVvJz.js";import{S as Ve}from"./SearchInput-CMdOUuSO.js";import{M as we}from"./Modal-BCIUwH-b.js";import{O as Ce,V as A}from"./index-DxoBGdjx.js";import{u as H}from"./AuthStore-BnYeBJES.js";import{u as Ae}from"./useBranchStore-kvv3vD_e.js";import"./useEmployeeStore-BJ_SZO4g.js";import{D as J}from"./DrapDown-CEm3nLdF.js";import{F as ze,u as ne,w as Oe}from"./xlsx-DTxMWUdD.js";import{t as De,B as G,a as Y}from"./api-C04JdqFc.js";import{D as _e}from"./index.es-Dy-HqQhS.js";/* empty css                         */import{B as We}from"./ButtonLoader-Z62NVHwI.js";import{U as Pe}from"./users-CXAhoVGa.js";import{U as ke}from"./user-check-BVVInUPf.js";import{C as Ne}from"./circle-check-big-DhDS6nah.js";import{C as Se}from"./circle-x-Dr6D4A3M.js";import{C as ye}from"./clock-CzOQJT5p.js";import{c as Le}from"./createLucideIcon-RccWoOaL.js";import{u as Fe}from"./use-click-outside-BhLpsQYS.js";import{F as Me}from"./funnel-BXR2-FhQ.js";import{S as qe}from"./square-pen-hueQTsQ_.js";import{P as Ge}from"./plus-HifIQSWH.js";import{X as Ie}from"./x-BfrbTbzo.js";import{B as Ye}from"./book-user-BTUNghSh.js";import"./index-knF4tUPh.js";/* empty css            */import"./index-DDa5wjlm.js";import"./iconBase-CajCgYY2.js";import"./react-_sXfQCJm.js";import"./moment-C5S46NFB.js";import"./clsx-B-dksMZM.js";import"./index-CyJ3O4p6.js";/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=[["path",{d:"M17 12H3",key:"8awo09"}],["path",{d:"m11 18 6-6-6-6",key:"8c2y43"}],["path",{d:"M21 5v14",key:"nzette"}]],Ke=Le("arrow-right-to-line",Xe);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}],["path",{d:"m9 9.5 2 2 4-4",key:"1dth82"}]],Je=Le("book-check",Qe);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 14.5 8",key:"12zbmj"}]],Re=Le("clock-1",Ze);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=[["path",{d:"M12 2a10 10 0 0 1 7.38 16.75",key:"175t95"}],["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["path",{d:"M2.5 8.875a10 10 0 0 0-.5 3",key:"1vce0s"}],["path",{d:"M2.83 16a10 10 0 0 0 2.43 3.4",key:"o3fkw4"}],["path",{d:"M4.636 5.235a10 10 0 0 1 .891-.857",key:"1szpfk"}],["path",{d:"M8.644 21.42a10 10 0 0 0 7.631-.38",key:"9yhvd4"}]],Ee=Le("clock-fading",et);function tt(){const[T,O]=a.useState(!1);return e.jsxs("div",{className:"text-medium dark:bg-gray-800 dark:text-gray-200",children:[e.jsxs("div",{className:"text-medium sm:flex gap-5",children:[e.jsxs("div",{className:"flex flex-col py-2 text-left mt-1",children:[e.jsx("label",{htmlFor:"",className:"text-sm text-gray-700 dark:text-gray-300 mb-3",children:"Reviewed By"}),e.jsx("input",{className:"max-w-[400px] w-[300px] bg-blue-200/25 dark:bg-gray-700 text-sm px-2 py-2 border border-gray-400 dark:border-gray-600 focus:outline-none focus:bg-gray-100 dark:focus:bg-gray-600 focus:border-gray-400 dark:focus:border-gray-500 rounded",type:"text"})]}),e.jsxs("div",{className:"flex flex-col py-2 text-left mt-1",children:[e.jsx("label",{htmlFor:"",className:"text-sm text-gray-700 dark:text-gray-300 mb-3",children:"status"}),e.jsx("input",{className:"max-w-[400px] w-[300px] bg-blue-200/25 dark:bg-gray-700 text-sm px-2 py-2 border border-gray-400 dark:border-gray-600 focus:outline-none focus:bg-gray-100 dark:focus:bg-gray-600 focus:border-gray-400 dark:focus:border-gray-500 rounded",type:"text"})]})]}),e.jsx("div",{className:"text-medium sm:flex gap-5",children:e.jsxs("div",{className:"flex flex-col py-2 text-left mt-1",children:[e.jsx("label",{htmlFor:"",className:"text-sm text-gray-700 dark:text-gray-300 mb-3",children:"Notes/Remarks"}),e.jsx("textarea",{className:" w-[625px] bg-blue-200/25 dark:bg-gray-700 text-sm px-2 py-2 border border-gray-400 dark:border-gray-600 focus:outline-none focus:bg-gray-100 dark:focus:bg-gray-600 focus:border-gray-400 dark:focus:border-gray-500 rounded"})]})}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-[var(--color-secondary)] hover:[var(--color-hover-secondary)] hover-effect text-gray-800 dark:text-gray-700 rounded hover:bg-gray-400 dark:hover:bg-gray-500 transition",disabled:T,children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-[var(--color-primary)] hover:bg-[var(--color-hover)]  text-white rounded hover:bg-gradient-to-b hover-effect transition",disabled:T,children:T?e.jsx(ButtonLoader,{}):"Create Branch"})]})]})}const at=()=>{const[T,O]=a.useState(""),[N,F]=a.useState(1),[S,X]=a.useState(""),[oe,W]=a.useState([]),[V,x]=a.useState(!1),[f,b]=a.useState(null),[_,$]=a.useState(null),[I,E]=a.useState(null),[U,D]=a.useState("department"),[de,g]=a.useState(!1),[j,z]=a.useState(null),w=H(i=>i.accessToken),M=H(i=>i.role),Z=H(i=>i.branchcode),{branchCodeOptions:R,fetchBranches:P,isLoading:ee}=Ae(),te=[{value:"all",label:"All Branches"},...R.map(i=>({value:i.value,label:i.label}))],le=[{id:"department",label:"Department View"},{id:"team",label:"Team View"}],K=i=>{if(!i)return"";const l=new Date(i),s=l.getFullYear(),p=(l.getMonth()+1).toString().padStart(2,"0"),h=l.getDate().toString().padStart(2,"0");return`${s}-${p}-${h}`},B=async()=>{x(!0);try{let i=`${G}/report/attendancesummary/read`;const l=new URLSearchParams;M==="superadmin"&&S&&S!=="all"?l.append("branchcode",S):M!=="superadmin"&&l.append("branchcode",Z),_&&l.append("startdate",K(_)),I&&l.append("enddate",K(I)),i+=`?${l.toString()}`;const s=await Y.get(i,{headers:{Authorization:`Bearer ${w}`}});if(s.data)if(s.data.data&&Array.isArray(s.data.data))b(s.data),W(s.data.data||[]);else{const p={data:[s.data.data||s.data],message:s.data.message};b(p),W([s.data.data||s.data])}}catch(i){console.error("Error fetching attendance report",i),A.error("Failed to fetch attendance report")}finally{x(!1)}};a.useEffect(()=>{P(w)},[w]),a.useEffect(()=>{B()},[S,_,I]);const ae=i=>{const[l,s]=i;$(l),E(s)},d=()=>{if(!f){A.error("No data to export");return}const i=ne.book_new();let l=[];l=(Array.isArray(f.data)?f.data:[f.data]).flatMap(h=>{var re,q,se,ge,xe,pe,he;if(!h)return[];const L={"Branch Code":h.branchcode,"Branch Name":h.branch_name,"Total Employees":h.total_employees,"Active Employees":h.total_active_employees,Present:((re=h.attendance_summary)==null?void 0:re.present_count)||0,Absent:((q=h.attendance_summary)==null?void 0:q.absent_count)||0,"On Leave":((se=h.attendance_summary)==null?void 0:se.leave_count)||0,"Approved Leave":((ge=h.attendance_summary)==null?void 0:ge.approved_leave_count)||0,"Half Day Leave":((xe=h.attendance_summary)==null?void 0:xe.half_day_leave_count)||0,"Hourly Leave":((pe=h.attendance_summary)==null?void 0:pe.hourly_leave_count)||0,"Waiting for Login":((he=h.attendance_summary)==null?void 0:he.waitingforlogin_count)||0},Q=(h.department_counts||[]).map(y=>({...L,Department:y.department||"N/A","Dept Employees":y.employee_count,"Dept Present":y.present_count,"Dept Absent":y.absent_count,"Dept On Leave":y.leave_count,"Dept Approved Leave":y.approved_leave_count,"Dept Half Day Leave":y.half_day_leave_count,"Dept Hourly Leave":y.hourly_leave_count,"Dept Waiting for Login":y.waitingforlogin_count})),ce=(h.team_counts||[]).map(y=>({...L,"Team ID":y.team_id,"Team Name":y.team_name,"Team Lead":y.teamleadname,"Team Employees":y.employee_count,"Team Present":y.present_count,"Team Absent":y.absent_count,"Team On Leave":y.leave_count,"Team Approved Leave":y.approved_leave_count,"Team Half Day Leave":y.half_day_leave_count,"Team Hourly Leave":y.hourly_leave_count,"Team Waiting for Login":y.waitingforlogin_count}));return[...Q,...ce]});const p=ne.json_to_sheet(l);ne.book_append_sheet(i,p,"Attendance Summary"),Oe(i,"AttendanceReport.xlsx")},r=f?(Array.isArray(f.data)?f.data:[f.data]).reduce((l,s)=>{var p,h,L,Q,ce,re,q;return s?{totalEmployees:l.totalEmployees+(s.total_employees||0),activeEmployees:l.activeEmployees+(s.total_active_employees||0),present:l.present+(((p=s.attendance_summary)==null?void 0:p.present_count)||0),absent:l.absent+(((h=s.attendance_summary)==null?void 0:h.absent_count)||0),leave:l.leave+(((L=s.attendance_summary)==null?void 0:L.leave_count)||0),approvedLeave:l.approvedLeave+(((Q=s.attendance_summary)==null?void 0:Q.approved_leave_count)||0),halfDayLeave:l.halfDayLeave+(((ce=s.attendance_summary)==null?void 0:ce.half_day_leave_count)||0),hourlyLeave:l.hourlyLeave+(((re=s.attendance_summary)==null?void 0:re.hourly_leave_count)||0),waitingForLogin:l.waitingForLogin+(((q=s.attendance_summary)==null?void 0:q.waitingforlogin_count)||0)}:l},{totalEmployees:0,activeEmployees:0,present:0,absent:0,leave:0,approvedLeave:0,halfDayLeave:0,hourlyLeave:0,waitingForLogin:0}):null,k=({value:i,icon:l,label:s,color:p})=>e.jsxs("div",{className:"flex flex-col bg-white w-full h-[100px] shadow-lg rounded-lg items-center justify-center dark:bg-gray-800",children:[e.jsx("p",{className:`text-xl font-extrabold ${p}`,children:i}),e.jsxs("div",{className:"flex gap-2",children:[l,e.jsx("h1",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:s})]})]}),ve=()=>[{data:"Department"},{data:"Total"},{data:"Present",icon:e.jsx(Ne,{className:"inline text-green-500",size:16})},{data:"Absent",icon:e.jsx(Se,{className:"inline text-red-500",size:16})},{data:"On Leave",icon:e.jsx(ye,{className:"inline text-yellow-500",size:16})},{data:"Approved Leave",icon:e.jsx(ke,{className:"inline text-blue-500",size:16})},{data:"Waiting",icon:e.jsx(Ee,{className:"inline text-gray-500",size:16})}],ue=()=>{if(!f)return[];const i=Array.isArray(f.data)?f.data:[f.data],l=new Map;return i.forEach(s=>{s&&(s.department_counts||[]).forEach(p=>{const h=p.department||"Unknown";l.has(h)||l.set(h,{department:h,employee_count:0,present_count:0,absent_count:0,leave_count:0,approved_leave_count:0,half_day_leave_count:0,hourly_leave_count:0,waitingforlogin_count:0});const L=l.get(h);l.set(h,{department:h,employee_count:L.employee_count+(p.employee_count||0),present_count:L.present_count+(p.present_count||0),absent_count:L.absent_count+(p.absent_count||0),leave_count:L.leave_count+(p.leave_count||0),approved_leave_count:L.approved_leave_count+(p.approved_leave_count||0),half_day_leave_count:L.half_day_leave_count+(p.half_day_leave_count||0),hourly_leave_count:L.hourly_leave_count+(p.hourly_leave_count||0),waitingforlogin_count:L.waitingforlogin_count+(p.waitingforlogin_count||0)})})}),Array.from(l.values()).map((s,p)=>({id:`${s.department}-${p}`,data:[{data:s.department||"N/A"},{data:s.employee_count},{data:s.present_count},{data:s.absent_count},{data:s.leave_count},{data:s.approved_leave_count},{data:s.waitingforlogin_count}]}))},m=()=>[{data:"Team"},{data:"Team Lead"},{data:"Total"},{data:"Present",icon:e.jsx(Ne,{className:"inline text-green-500",size:16})},{data:"Absent",icon:e.jsx(Se,{className:"inline text-red-500",size:16})},{data:"On Leave",icon:e.jsx(ye,{className:"inline text-yellow-500",size:16})},{data:"Approved Leave",icon:e.jsx(ke,{className:"inline text-blue-500",size:16})},{data:"Waiting",icon:e.jsx(Ee,{className:"inline text-gray-500",size:16})}],fe=()=>f?(Array.isArray(f.data)?f.data:[f.data]).flatMap(s=>s?(s.team_counts||[]).map(p=>({...p,branch_name:s.branch_name})):[]).map((s,p)=>({id:s.team_id||`team-${p}`,data:[{data:s.team_name},{data:s.teamleadname},{data:s.employee_count},{data:s.present_count},{data:s.absent_count},{data:s.leave_count},{data:s.approved_leave_count},{data:s.waitingforlogin_count}]})):[];return e.jsxs(e.Fragment,{children:[e.jsx(Ce,{position:De,reverseOrder:!1}),e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsx("h2",{className:"text-xl font-semibold text-[var(--color-primary)] dark:text-[var(--color-primary)] mb-4",children:"Attendance Report"})}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between gap-4 mb-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 w-full md:w-auto",children:[M==="superadmin"&&e.jsx(J,{options:te,selectedValue:S,onSelect:X,placeholder:"Filter By Branch",className:"w-full md:w-[250px]",isLoading:ee}),e.jsx("div",{className:"w-full md:w-[300px]",children:e.jsx(_e,{selectsRange:!0,startDate:_,endDate:I,onChange:ae,placeholderText:"Select date range",className:"w-full p-2 border rounded dark:bg-gray-800 dark:border-gray-700",isClearable:!0})})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:B,className:"flex items-center justify-center text-white bg-[var(--color-primary)] hover-effect dark:bg-red-800 focus:outline-none font-medium text-sm rounded-sm px-4 py-2",disabled:V,children:V?e.jsx(We,{}):"Refresh"}),e.jsxs("button",{onClick:d,className:"flex items-center justify-center text-gray-400 bg-white focus:outline-none font-medium text-sm rounded-sm border border-dotted border-gray-400 hover:text-red-700/70 px-3 dark:bg-gray-800 dark:text-gray-300 py-2",children:[e.jsx(ze,{className:"mr-1"}),"Export Excel"]})]})]}),r&&e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-5 mb-10",children:[e.jsx(k,{value:r.totalEmployees,icon:e.jsx(Pe,{className:"text-blue-600",size:20}),label:"Total Employees",color:"text-blue-600"}),e.jsx(k,{value:r.activeEmployees,icon:e.jsx(ke,{className:"text-green-600",size:20}),label:"Active Employees",color:"text-green-600"}),e.jsx(k,{value:r.present,icon:e.jsx(Ne,{className:"text-green-600",size:20}),label:"Present Today",color:"text-green-600"}),e.jsx(k,{value:r.absent,icon:e.jsx(Se,{className:"text-red-600",size:20}),label:"Absent Today",color:"text-red-600"}),e.jsx(k,{value:r.leave,icon:e.jsx(ye,{className:"text-yellow-600",size:20}),label:"On Leave",color:"text-yellow-600"}),e.jsx(k,{value:r.approvedLeave,icon:e.jsx(Je,{className:"text-purple-600",size:20}),label:"Approved Leave",color:"text-purple-600"}),e.jsx(k,{value:r.halfDayLeave,icon:e.jsx(Ee,{className:"text-orange-600",size:20}),label:"Half Day Leave",color:"text-orange-600"}),e.jsx(k,{value:r.waitingForLogin,icon:e.jsx(Ke,{className:"text-gray-600",size:20}),label:"Waiting for Login",color:"text-gray-600"})]}),e.jsx("div",{className:"flex border-b border-gray-200 dark:border-gray-700 mb-4",children:le.map(i=>e.jsx("button",{className:`px-4 py-2 font-medium text-sm ${U===i.id?"text-[var(--color-primary)] border-b-2 border-[var(--color-primary)]":"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"}`,onClick:()=>D(i.id),children:i.label},i.id))}),e.jsx("div",{className:"mb-4",children:e.jsx(Ve,{value:T,onChange:O,placeholder:`Search ${U==="department"?"departments":"teams"}...`})}),U==="department"?e.jsx(be,{thead:ve,tbody:ue,maxHeight:"500px"}):e.jsx(be,{thead:m,tbody:fe,maxHeight:"500px"}),e.jsx("div",{className:"bottom-0 border-t border-gray-200 dark:border-gray-700 p-4",children:e.jsx(Be,{total:U==="department"?ue().length:fe().length,currentPage:N,defaultPageSize:10,onChange:F,paginationLabel:U==="department"?"departments":"teams",isScroll:!0})}),e.jsx(we,{isVisible:de,className:"w-full md:w-[700px]",onClose:()=>g(!1),title:"Employee Attendance Details",children:j&&e.jsxs("div",{className:"flex flex-col gap-6 dark:bg-gray-800 bg-white p-6 rounded-lg",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold border-b pb-2 text-gray-800 dark:text-gray-100 border-gray-200 dark:border-gray-700",children:"Employee Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Employee Name"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mt-1",children:j.name||"N/A"})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Employee ID"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mt-1",children:j.empId||"N/A"})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Department"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mt-1",children:j.department||"N/A"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold border-b pb-2 text-gray-800 dark:text-gray-100 border-gray-200 dark:border-gray-700",children:"Attendance Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Status"}),e.jsx("p",{className:`text-sm font-medium mt-1 ${j.status==="Present"?"text-green-600":j.status==="Absent"?"text-red-600":j.status==="On Leave"?"text-yellow-600":"text-gray-600"}`,children:j.status||"N/A"})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Check-in Time"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mt-1",children:j.checkIn||"N/A"})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Check-out Time"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mt-1",children:j.checkOut||"N/A"})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Total Hours"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mt-1",children:j.totalHours||"N/A"})]})]})]}),j.status==="On Leave"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold border-b pb-2 text-gray-800 dark:text-gray-100 border-gray-200 dark:border-gray-700",children:"Leave Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Leave Type"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mt-1",children:j.leaveType||"N/A"})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Leave Days"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mt-1",children:j.leaveDays||"N/A"})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"From Date"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mt-1",children:j.leaveStart||"N/A"})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"To Date"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mt-1",children:j.leaveEnd||"N/A"})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-200 dark:border-gray-700",children:e.jsx("button",{type:"button",className:"px-5 py-2 bg-gray-800 hover:bg-gray-700 dark:bg-gray-700 dark:hover:bg-gray-600 text-white dark:text-gray-100 rounded-md transition-colors duration-200 font-medium text-sm shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 dark:focus:ring-gray-400",onClick:()=>g(!1),children:"Close"})})]})})]})},rt=()=>{var c;const T=Fe({query:"(max-width: 768px)"}),[O,N]=a.useState(1),[F,S]=a.useState(!1),[X,oe]=a.useState(0),[W,V]=a.useState(null),[x,f]=a.useState(""),[b,_]=a.useState(""),[$,I]=a.useState(10),[E,U]=a.useState([]),[D,de]=a.useState(null),[g,j]=a.useState(null),[z,w]=a.useState([]),[M,Z]=a.useState(!1),[R,P]=a.useState(!1),[ee,te]=a.useState(!1),[le,K]=a.useState(null),[B,ae]=a.useState(!0),d=H(t=>t.accessToken),C=H(t=>t.permissions),r=H(t=>t.staff_id),k=H(t=>t.branchcode),[ve,ue]=a.useState(!1),m=((c=C[0])==null?void 0:c.role)||"employee",[fe,i]=a.useState(null),{branchCodeOptions:l,fetchBranches:s,isLoading:p}=Ae(),h=[{value:10,label:"10 per page"},{value:20,label:"20 per page"},{value:50,label:"50 per page"},{value:100,label:"100 per page"}],L=()=>m==="superadmin"?l:m==="hr"?l.filter(t=>t.value===k):[];a.useEffect(()=>{(m==="superadmin"||m==="hr")&&s(d)},[d,m]),a.useEffect(()=>{m==="hr"&&f(k)},[m,k]),a.useEffect(()=>{m!=="hr"&&m!=="superadmin"&&_(r)},[m,r]),a.useEffect(()=>{(m==="superadmin"||m==="hr")&&(async()=>{if(m==="superadmin"&&!x||m==="hr"&&!k){w([]);return}S(!0);try{const u=`${G}/users/dropdown?branchcode=${m==="hr"?k:x}`,v=await Y.get(u,{headers:{Authorization:`Bearer ${d}`}});if(v.data&&v.data.data){const me=v.data.data.map(ie=>({value:ie.staff_id,label:`${ie.firstname} ${ie.lastname} (${ie.staff_id})`}));w(me)}}catch(o){console.error("Error fetching staff list",o),A.error("Failed to fetch staff")}finally{S(!1)}})()},[x,d,m,k]);const Q=async()=>{if(!(m==="superadmin"||m==="hr"))try{const t=new Date().toISOString().split("T")[0],o=`${G}/users/attendance-log/read?staff_id=${r}`,u=await Y.get(o,{headers:{Authorization:`Bearer ${d}`}});console.log("responseee",u),u.data&&u.data.data?(K(u.data.data),te(u.data.data.check_in&&!u.data.data.check_out)):(K(null),te(!1))}catch(t){console.error("Error checking today's attendance",t),A.error("Failed to check today's attendance")}},ce=async()=>{var t,o;try{const u=new Date,v=u.toISOString().split("T")[0],me=u.toISOString(),ie={staff_id:r,attendance_date:v,check_in:me},He=await Y.post(`${G}/users/attendance-log/create`,ie,{headers:{Authorization:`Bearer ${d}`}});console.log("responseeee",He),P(!1),A.success("Checked in successfully"),await Q(),await q()}catch(u){console.error("Error during check in",u),A.error(((o=(t=u.response)==null?void 0:t.data)==null?void 0:o.message)||"Failed to check in")}},re=async()=>{var t,o;try{if(!le){A.error("No check-in record found for today");return}const v=new Date().toISOString(),me={id:le._id,check_out:v},ie=await Y.post(`${G}/users/attendance-log/create`,me,{headers:{Authorization:`Bearer ${d}`}});console.log("checkoutdataaa",ie),A.success("Checked out successfully"),await Q(),await q(),P(!1)}catch(u){console.error("Error during check out",u),A.error(((o=(t=u.response)==null?void 0:t.data)==null?void 0:o.message)||"Failed to check out")}},q=async()=>{S(!0);try{let t=`${G}/users/attendance-log/read`;const o=new URLSearchParams;m==="superadmin"||m==="hr"?b&&o.append("staff_id",b):o.append("staff_id",r),D&&o.append("start_date",se(D)),g&&o.append("end_date",se(g)),o.append("page",O),o.append("limit",$),o.append("sort","-date"),t+=`?${o.toString()}`;const u=await Y.get(t,{headers:{Authorization:`Bearer ${d}`}});u.data&&(U(u.data.data||[]),oe(u.data.totalDocuments||0))}catch(t){console.error("Error fetching attendance logs",t),A.error("Failed to fetch attendance logs"),V("Failed to fetch data")}finally{S(!1)}},se=t=>{if(!t)return"";const o=new Date(t),u=o.getFullYear(),v=(o.getMonth()+1).toString().padStart(2,"0"),me=o.getDate().toString().padStart(2,"0");return`${u}-${v}-${me}`},ge=t=>{N(t)},xe=t=>{f(t),_(""),N(1)},pe=t=>{_(t),N(1)},he=t=>{I(t),N(1)},y=()=>{if(!E||E.length===0){A.error("No data to export");return}const t=E.map(v=>({"Staff ID":v.staff_id,"Branch Code":v.branchcode,Date:v.date,"Check In":v.check_in,"Check Out":v.check_out||"N/A","Total Hours":v.total_hours||"N/A",Status:v.status})),o=ne.book_new(),u=ne.json_to_sheet(t);ne.book_append_sheet(o,u,"AttendanceLogs"),Oe(o,"AttendanceLogs.xlsx")};a.useEffect(()=>{q(),m!=="superadmin"&&m!=="hr"&&Q()},[O,$,b,D,g,m,k]);const Te=t=>{i(t),ue(!0)},$e=t=>{if(!t||isNaN(t))return"N/A";const o=Math.floor(t/3600),u=Math.floor(t%3600/60),v=t%60;return`${o}:${String(u).padStart(2,"0")}:${String(v).padStart(2,"0")}`},je=()=>[{data:"Staff ID"},{data:"Staff Name"},{data:"Date"},{data:"Check In"},{data:"Check Out"},{data:"Total Hours"},{data:"Status"},{data:"Action"}],n=()=>E?E.map(t=>({id:t._id,data:[{data:t.staff_id},{data:t.staff_name},{data:new Date(t.create_datetime).toLocaleDateString()},{data:se(t.check_in)||"N/A"},{data:se(t.check_out)||"N/A"},{data:$e(t.duration)},{data:e.jsxs("div",{className:`px-3 py-1 rounded-full text-sm inline-flex items-center ${t.status==="checkin"?"bg-green-100 text-green-800":t.status==="checkout"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:[t.status==="present"?e.jsx(Ne,{className:"w-3 h-3 mr-1"}):t.status==="absent"?e.jsx(Se,{className:"w-3 h-3 mr-1"}):e.jsx(ye,{className:"w-3 h-3 mr-1"}),t.status]})},{data:e.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:e.jsx("button",{className:"p-1 text-[var(--color-primary)] rounded hover:text-gray-500 dark:hover:text-gray-300",onClick:()=>Te(t),title:"Edit",children:e.jsx(qe,{size:18})})}),className:"action-cell"}]})):[];return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-col min-h-screen",children:e.jsxs("div",{className:"p-4 flex-grow",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-[var(--color-primary)] dark:text-[var(--color-primary)]",children:"Attendance Logs"}),T&&e.jsxs("button",{onClick:()=>Z(!M),className:"p-2 bg-gray-200 rounded-md",children:[e.jsx(Me,{size:18,className:"mr-1"}),M?"Hide Filters":"Show Filters"]}),m!=="superadmin"&&m!=="hr"&&e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:()=>{ae(!0),P(!0)},className:`flex items-center justify-center text-white font-medium text-sm rounded-sm px-5 py-2.5 ${ee?"bg-gray-400 cursor-not-allowed":"bg-[var(--color-primary)] hover-effect"}`,disabled:ee,children:[!T&&"Check In",e.jsx(Re,{className:"ml-4",size:20})]}),e.jsxs("button",{onClick:()=>{ae(!1),P(!0)},className:`flex items-center justify-center text-white font-medium text-sm rounded-sm px-5 py-2.5 ${ee?"bg-[var(--color-primary)] hover-effect":"bg-gray-400 cursor-not-allowed"}`,children:[!T&&"Check Out",e.jsx(Re,{className:"ml-4",size:20})]})]})]}),e.jsx(Ce,{position:De,reverseOrder:!1}),e.jsx("div",{className:`${T&&!M?"hidden":"block"} mb-4`,children:e.jsxs("div",{className:`grid grid-cols-1 ${m!=="superadmin"&&m!=="hr"?"md:grid-cols-1 lg:grid-cols-1 gap-3":"md:grid-cols-3 lg:grid-cols-3 gap-20"}`,children:[m==="superadmin"&&e.jsx(J,{options:L(),selectedValue:x,onSelect:xe,placeholder:"Select Branch",className:"w-[245px]",isLoading:p}),(m==="superadmin"||m==="hr")&&e.jsx(J,{options:z,selectedValue:b,onSelect:pe,placeholder:"Select Staff",className:"w-[245px]",disabled:m==="hr"?!1:!x,isLoading:F})]})}),e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx(J,{options:h,selectedValue:$,onSelect:he,placeholder:"Items per page",className:"w-[150px]"}),e.jsxs("button",{onClick:y,className:"flex items-center justify-center text-gray-400 bg-white focus:outline-non font-medium text-sm rounded-sm border border-dotted border-gray-400 hover:text-red-700/70 px-3 dark:bg-gray-800 dark:text-gray-300 py-2",disabled:E.length===0,children:[e.jsx(ze,{className:"mr-1"}),!T&&"Export Excel"]})]}),F&&e.jsx("div",{className:"text-center py-4",children:"Loading..."}),W&&e.jsx("div",{className:"text-red-500 text-center py-4",children:W}),e.jsx("div",{className:"overflow-x-auto",children:e.jsx(be,{thead:je,tbody:n,responsive:!0,className:"min-w-full"})}),e.jsx("div",{className:"bottom-0 border-t border-gray-200 dark:border-gray-700 p-4",children:e.jsx(Be,{total:X,currentPage:O,defaultPageSize:$,onChange:ge,paginationLabel:"attendance logs",isScroll:!0})})]})}),e.jsx(we,{isVisible:R,className:"w-full md:w-[400px]",onClose:()=>P(!1),title:B?"Check In Confirmation":"Check Out Confirmation",children:e.jsxs("div",{className:"p-4",children:[e.jsx("p",{className:"mb-4",children:B?"Are you sure you want to check in?":"Are you sure you want to check out?"}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{onClick:()=>P(!1),className:"px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-100",children:"Cancel"}),e.jsx("button",{onClick:B?ce:re,className:"px-4 py-2 bg-[var(--color-primary)] text-white rounded-md hover:bg-red-800",children:B?"Check In":"Check Out"})]})]})})]})},st=()=>{var ae;const T=Fe({query:"(max-width: 768px)"}),[O,N]=a.useState(!1),[F,S]=a.useState([]),[X,oe]=a.useState(""),[W,V]=a.useState(!1),[x,f]=a.useState(null),[b,_]=a.useState(new Date),[$,I]=a.useState("present"),[E,U]=a.useState(""),[D,de]=a.useState(!1),g=H(d=>d.accessToken),j=H(d=>d.permissions),z=H(d=>d.branchcode),w=((ae=j[0])==null?void 0:ae.role)||"employee",{branchCodeOptions:M,fetchBranches:Z,isLoading:R}=Ae();a.useEffect(()=>{(w==="superadmin"||w==="hr")&&Z(g)},[g,w]),a.useEffect(()=>{w==="hr"&&(oe(z),P(z))},[w,z]);const P=async d=>{N(!0);try{const C=`${G}/users/read?branchcode=${d}`,r=await Y.get(C,{headers:{Authorization:`Bearer ${g}`}});r.data&&S(r.data.data)}catch(C){console.error("Error fetching staff list",C),A.error("Failed to fetch staff")}finally{N(!1)}},ee=d=>{oe(d),P(d)},te=d=>{f(d),V(!0)},le=async()=>{var d,C;if(x)try{N(!0);const r=b.toISOString().split("T")[0],k={staff_id:x.staff_id,branchcode:x.branchcode,attendance_date:r,status:$,remarks:E};await Y.post(`${G}/users/attendance/create`,k,{headers:{Authorization:`Bearer ${g}`}}),A.success("Attendance recorded successfully"),V(!1)}catch(r){console.error("Error creating attendance",r),A.error(((C=(d=r.response)==null?void 0:d.data)==null?void 0:C.message)||"Failed to record attendance")}finally{N(!1)}},K=()=>[{data:"Staff ID"},{data:"Name"},{data:"Department"},{data:"Designation"},{data:"Branch"},{data:"Actions"}],B=()=>F.map(d=>({id:d.staff_id,data:[{data:d.staff_id},{data:`${d.firstname} ${d.lastname}`},{data:d.department},{data:d.designation},{data:d.branchcode},{data:e.jsxs("button",{onClick:()=>te(d),className:"flex items-center justify-center text-white bg-[var(--color-primary)] hover-effect text-sm rounded-sm px-3 py-1.5",children:[e.jsx(Ge,{size:16,className:"mr-1"}),"Add Attendance"]})}]}));return e.jsxs("div",{className:"flex flex-col min-h-screen",children:[e.jsxs("div",{className:"p-4 flex-grow",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-[var(--color-primary)] dark:text-[var(--color-primary)]",children:"Attendance Sheet"}),e.jsx(Ce,{position:De,reverseOrder:!1}),T&&e.jsxs("button",{onClick:()=>de(!D),className:"p-2 bg-gray-200 rounded-md",children:[e.jsx(Me,{size:18,className:"mr-1"}),D?"Hide Filters":"Show Filters"]})]}),e.jsx("div",{className:`${T&&!D?"hidden":"block"} mb-4`,children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:(w==="superadmin"||w==="hr")&&e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(J,{options:M,selectedValue:X,onSelect:ee,placeholder:"Select Branch",className:"w-[50%]",isLoading:R,disabled:w==="hr"})})})}),O&&e.jsx("div",{className:"text-center py-4",children:"Loading..."}),F.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsx(be,{thead:K,tbody:B,responsive:!0,className:"min-w-full"})}):e.jsx("div",{className:"text-center py-10 text-gray-500",children:X?"No staff members found in this branch":"Please select a branch to view staff members"})]}),e.jsx(we,{isVisible:W,className:"w-full md:w-[600px]",onClose:()=>V(!1),title:"Record Attendance",children:e.jsxs("div",{className:"flex flex-col gap-6 dark:bg-gray-800 bg-white p-6 rounded-lg",children:[x&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Staff ID"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mt-1",children:x.staff_id})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Staff Name"}),e.jsxs("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mt-1",children:[x.firstname," ",x.lastname]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Attendance Date"}),e.jsx(_e,{selected:b,onChange:d=>_(d),className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",dateFormat:"yyyy-MM-dd"})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Status"}),e.jsxs("select",{value:$,onChange:d=>I(d.target.value),className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",children:[e.jsx("option",{value:"present",children:"Present"}),e.jsx("option",{value:"absent",children:"Absent"}),e.jsx("option",{value:"halfday",children:"Half Day"}),e.jsx("option",{value:"leave",children:"Leave"})]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg col-span-2 border border-gray-100 dark:border-gray-700",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Remarks"}),e.jsx("textarea",{value:E,onChange:d=>U(d.target.value),className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none border rounded p-2",rows:"3",placeholder:"Enter remarks (optional)"})]})]})}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("button",{type:"button",className:"px-5 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 rounded-md transition-colors duration-200 font-medium text-sm",onClick:()=>V(!1),disabled:O,children:"Cancel"}),e.jsx("button",{type:"button",className:"px-5 py-2 bg-[var(--color-primary)] hover:bg-red-800 text-white rounded-md transition-colors duration-200 font-medium text-sm shadow-sm",onClick:le,disabled:O,children:O?"Saving...":"Save Attendance"})]})]})})]})},nt=()=>{var je;const T=Fe({query:"(max-width: 768px)"}),[O,N]=a.useState(1),[F,S]=a.useState(!1),[X,oe]=a.useState(0),[W,V]=a.useState(null),[x,f]=a.useState(""),[b,_]=a.useState(""),[$,I]=a.useState(""),[E,U]=a.useState([]),[D,de]=a.useState(10),[g,j]=a.useState(null),[z,w]=a.useState(null),[M,Z]=a.useState(null),[R,P]=a.useState(null),[ee,te]=a.useState([]),[le,K]=a.useState([]),B=H(n=>n.accessToken),ae=H(n=>n.permissions),d=H(n=>n.staff_id),C=H(n=>n.branchcode),r=((je=ae[0])==null?void 0:je.role)||"employee",{branchCodeOptions:k,fetchBranches:ve,isLoading:ue}=Ae(),m=[{value:10,label:"10 per page"},{value:20,label:"20 per page"},{value:50,label:"50 per page"},{value:100,label:"100 per page"}],fe=[{value:"present",label:"Present"},{value:"absent",label:"Absent"},{value:"leave",label:"Leave"},{value:"halfday",label:"Half Day"}],i=()=>r==="superadmin"?k:r==="team-lead"?k.filter(n=>n.value===C):[];a.useEffect(()=>{(r==="superadmin"||r==="team-lead")&&ve(B)},[B,r]),a.useEffect(()=>{r==="team-lead"&&f(C)},[r,C]),a.useEffect(()=>{r!=="team-lead"&&r!=="superadmin"&&I(d)},[r,d]),a.useEffect(()=>{(r==="superadmin"||r==="team-lead")&&(async()=>{if(!x){K([]);return}try{const c=`${G}/teams/read?branchcode=${x}`,t=await Y.get(c,{headers:{Authorization:`Bearer ${B}`}});if(t.data&&t.data.data){const o=t.data.data.map(u=>({value:u.team_id,label:u.team_name}));K(o)}}catch(c){console.error("Error fetching teams",c),A.error("Failed to fetch teams")}})()},[x,B,r]),a.useEffect(()=>{(r==="superadmin"||r==="team-lead")&&(async()=>{if(r==="superadmin"&&!x||r==="team-lead"&&!C){te([]);return}S(!0);try{let t=`${G}/users/read?branchcode=${r==="team-lead"?C:x}`;b&&(t+=`&team_id=${b}`);const o=await Y.get(t,{headers:{Authorization:`Bearer ${B}`}});if(o.data&&o.data.data){const u=o.data.data.map(v=>({value:v.staff_id,label:`${v.firstname} ${v.lastname} (${v.staff_id})`}));te(u)}}catch(c){console.error("Error fetching staff list",c),A.error("Failed to fetch staff")}finally{S(!1)}})()},[x,b,B,r,C]);const l=async()=>{const n=r!=="team-lead"&&r!=="superadmin"?d:$;if((r==="superadmin"||r==="team-lead")&&!n&&!b){A.error("Please select at least Staff or Team to filter");return}S(!0);try{let c=`${G}/users/attendance/read?page=${O}&limit=${D}`;n&&(c+=`&staff_id=${encodeURIComponent(n)}`),x&&(c+=`&branchcode=${encodeURIComponent(x)}`),b&&(c+=`&team_id=${encodeURIComponent(b)}`),z&&(c+=`&start_date=${s(z)}`),M&&(c+=`&end_date=${s(M)}`),R&&(c+=`&attendance_date=${s(R)}`),E.length>0&&E.forEach(o=>{c+=`&status=${encodeURIComponent(o)}`});const t=await Y.get(c,{headers:{Authorization:`Bearer ${B}`}});t.data&&(j(t.data),oe(t.data.totalDocuments||0))}catch(c){console.error("Error fetching attendance data",c),A.error("Failed to fetch attendance data"),V("Failed to fetch data")}finally{S(!1)}},s=n=>{if(!n)return"";const c=new Date(n),t=c.getFullYear(),o=(c.getMonth()+1).toString().padStart(2,"0"),u=c.getDate().toString().padStart(2,"0");return`${t}-${o}-${u}`},p=n=>{N(n),l()},h=n=>{f(n),_(""),I(""),N(1)},L=n=>{_(n),I(""),N(1)},Q=n=>{I(n),N(1)},ce=n=>{U(n),N(1)},re=n=>{de(n),N(1)},q=n=>{const[c,t]=n;w(c),Z(t),P(null)},se=n=>{P(n),w(null),Z(null)},ge=()=>{w(null),Z(null)},xe=()=>{P(null)},pe=()=>{if(!(g!=null&&g.data)||g.data.length===0){A.error("No data to export");return}const n=g.data.map(o=>({"Staff ID":o.staff_id,"Staff Name":o.staff_name,Date:o.attendance_date,Status:o.status,"Total Hours":o.total_worked_hours,Branch:o.branch_name||"N/A",Team:o.team_id||"N/A",Designation:o.designation,Department:o.department,Remarks:o.remarks||"N/A"})),c=ne.book_new(),t=ne.json_to_sheet(n);ne.book_append_sheet(c,t,"AttendanceReport"),Oe(c,"AttendanceReport.xlsx")},he=()=>{l()},y=n=>{let c="",t="";switch(n.toLowerCase()){case"present":c="bg-green-100",t="text-green-800";break;case"absent":c="bg-red-100",t="text-red-800";break;case"leave":c="bg-blue-100",t="text-blue-800";break;case"halfday":c="bg-yellow-100",t="text-yellow-800";break;default:c="bg-gray-100",t="text-gray-800"}return e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${c} ${t}`,children:n.charAt(0).toUpperCase()+n.slice(1)})},Te=()=>[{data:"Staff ID"},{data:"Staff Name"},{data:"Date"},{data:"Status"},{data:"Total Hours"},{data:"Branch"},{data:"Team"}],$e=()=>g!=null&&g.data?g.data.map((n,c)=>({id:n.id||c,data:[{data:n.staff_id},{data:n.staff_name},{data:new Date(n.attendance_date).toLocaleDateString()},{data:y(n.status)},{data:n.total_worked_hours},{data:n.branch_name||"N/A"},{data:n.team_id||"N/A"}]})):[];return e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex flex-col min-h-screen",children:e.jsxs("div",{className:"p-4 flex-grow",children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsx("h2",{className:"text-xl font-semibold text-[var(--color-primary)] dark:text-[var(--color-primary)] mb-5",children:"Attendance Report"})}),e.jsx(Ce,{position:De,reverseOrder:!1}),e.jsxs("div",{className:"flex flex-col gap-4 mb-5",children:[e.jsxs("div",{className:`grid grid-cols-1 ${r!=="superadmin"&&r!=="team-lead"?"md:grid-cols-2 lg:grid-cols-2 gap-3":"md:grid-cols-4 lg:grid-cols-4 gap-20"}`,children:[(r==="superadmin"||r==="team-lead")&&e.jsx(J,{options:i(),selectedValue:x,onSelect:h,placeholder:"Select Branch",className:"w-[245px]",isLoading:ue,disabled:r==="team-lead"}),(r==="superadmin"||r==="team-lead")&&e.jsx(J,{options:le,selectedValue:b,onSelect:L,placeholder:"Select Team",className:"w-[245px]",disabled:r==="team-lead"?!C:!x,isLoading:F}),(r==="superadmin"||r==="team-lead")&&e.jsx(J,{options:ee,selectedValue:$,onSelect:Q,placeholder:"Select Staff",className:"w-[245px]",disabled:r==="team-lead"?!C:!x,isLoading:F}),e.jsx(J,{options:fe,selectedValue:E,onSelect:ce,placeholder:"Select Status",className:"w-[245px]",isMulti:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"w-[245px] relative",children:[e.jsx(_e,{selectsRange:!0,startDate:z,endDate:M,onChange:q,placeholderText:"Select date range",className:"w-full p-2 border rounded h-[40px]",isClearable:!0}),(z||M)&&e.jsx("button",{onClick:ge,className:"absolute right-2 top-2 text-gray-500 hover:text-gray-700",children:e.jsx(Ie,{size:16})})]}),e.jsxs("div",{className:"w-[245px] relative",children:[e.jsx(_e,{selected:R,onChange:se,placeholderText:"Select specific date",className:"w-full p-2 border rounded h-[40px]",isClearable:!0}),R&&e.jsx("button",{onClick:xe,className:"absolute right-2 top-2 text-gray-500 hover:text-gray-700",children:e.jsx(Ie,{size:16})})]}),e.jsx(J,{options:m,selectedValue:D,onSelect:re,placeholder:"Items per page",className:"w-[245px]"})]}),e.jsxs("div",{className:"flex flex-wrap justify-between items-center",children:[e.jsx("div",{className:`flex ${r!=="superadmin"&&r!=="team-lead"?"gap-91":"gap-19"}`,children:e.jsxs("button",{onClick:pe,className:"flex items-center justify-center text-gray-400 bg-white focus:outline-non font-medium text-sm rounded-sm border border-dotted border-gray-400 hover:text-red-700/70 px-2 dark:bg-gray-800 dark:text-gray-300 py-2 w-[245px]",disabled:!(g!=null&&g.data),children:[e.jsx(ze,{className:"mr-1"}),!T&&"Export Excel"]})}),e.jsx("button",{onClick:he,className:"flex items-center justify-center text-white bg-[var(--color-primary)] hover-effect dark:bg-red-800 focus:outline-non font-medium text-sm rounded-sm px-5 py-2.5",disabled:(r!=="team-lead"&&r!=="superadmin"?!R&&!z:!$&&!b&&!R&&!z)||F,children:F?"Loading...":"Generate Report"})]})]}),F&&e.jsx("div",{className:"text-center py-4",children:"Loading..."}),W&&e.jsx("div",{className:"text-red-500 text-center py-4",children:W}),(g==null?void 0:g.data)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6 p-4 bg-gray-200 dark:bg-gray-800 rounded-lg",children:[e.jsx("h3",{className:"text-lg text-[var(--color-primary)] font-semibold mb-2",children:"Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-gray-500 mb-3 flex items-center",children:[e.jsx(Ye,{className:"mr-1",size:16})," Total Records"]}),e.jsx("p",{className:"font-medium",children:g.totalDocuments})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-gray-500 mb-3 flex items-center",children:[e.jsx(Pe,{className:"mr-1",size:16})," Unique Staff"]}),e.jsx("p",{className:"font-medium",children:new Set(g.data.map(n=>n.staff_id)).size})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-gray-500 mb-3 flex items-center",children:[e.jsx(ye,{className:"mr-1",size:16})," Date Range"]}),e.jsx("p",{className:"font-medium",children:g.data.length>0?`${new Date(g.data[0].attendance_date).toLocaleDateString()} - 
                           ${new Date(g.data[g.data.length-1].attendance_date).toLocaleDateString()}`:"N/A"})]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[e.jsx(ke,{className:"mr-2",size:20})," Attendance Records"]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsx(be,{thead:Te,tbody:$e,responsive:!0,className:"min-w-full"})})]}),e.jsx("div",{className:"bottom-0 border-t border-gray-200 dark:border-gray-700 p-4",children:e.jsx(Be,{total:X,currentPage:O,defaultPageSize:D,onChange:p,paginationLabel:"records",isScroll:!0})})]}),!F&&!g&&e.jsx("div",{className:"text-center py-10 text-gray-500",children:r!=="team-lead"&&r!=="superadmin"?!R&&!z?"Please select date to generate report":"Click 'Generate Report' to view your attendance":r==="team-lead"?C?!$&&!b?"Please select Staff or Team and date":!R&&!z?"Please select date":"Click 'Generate Report' to view data":"Loading branch information...":x?!$&&!b?"Please select Staff or Team":!R&&!z?"Please select date":"Click 'Generate Report' to view data":"Please select Branch to view available options"})]})})})},ot=()=>{const[T,O]=a.useState(""),[N,F]=a.useState(1),[S,X]=a.useState(!1),[oe,W]=a.useState(""),[V,x]=a.useState([]),[f,b]=a.useState(""),[_,$]=a.useState("employeeattandance"),I=[{id:"SAL_12",date:"25-05-2025",name:"Bharathi",status:"Presend",checkin:"true",checkInTime:"09:04 AM",checkout:"true",checkouttime:"06:00 PM"},{id:"AC_12",date:"25-05-2025",name:"Karthick",status:"Absent",checkin:"false",checkInTime:"--",checkouttime:"--",checkout:"false"}],E=[{id:"employeeattandance",label:" Attendance Log"},{id:"createattendance",label:" Attendance Entry"},{id:"attendancereport",label:"Report"},{id:"attendancesheet",label:"Attendance Report"}],U=()=>I;return a.useEffect(()=>{x(U())},[]),e.jsxs("div",{className:"flex flex-col min-h-screen",children:[e.jsx("div",{className:"  dark:border-gray-700 mb-[60px] ",children:e.jsx("nav",{className:"flex justify-evenly -mb-px",children:E.map((D,de)=>e.jsxs(e.Fragment,{children:[de>0&&e.jsx("span",{className:"bg-gray-300 dark:bg-red-700 w-[50px] h-[2px] mt-5 items-center"}),e.jsx("button",{onClick:()=>$(D.id),className:` font-medium text-sm ${_===D.id?" text-gray-200 dark:bg-gray-800 dark:text-red-800 hover:border-gray-300 bg-red-700 w-[150px] h-[40px] rounded-sm ":"border-transparent text-gray-700 hover:text-red-700 dark:bg-gray-600 dark:text-gray-100 hover:border-gray-300 bg-gray-200 w-[150px] h-[40px] rounded-sm "}`,children:D.label},D.id)]}))})}),e.jsxs("div",{className:"p-4 flex-grow",children:[_==="employeeattandance"&&e.jsx(rt,{}),_==="attendancesheet"&&e.jsx("div",{children:e.jsx(nt,{})}),_==="createattendance"&&e.jsx("div",{children:e.jsx(st,{})}),_==="attendancereport"&&e.jsx("div",{children:e.jsx(at,{})}),e.jsx(we,{isVisible:S,className:"w-full md:w-[800px]",onClose:()=>X(!1),title:"ATTENDANCE APPROVAL ",children:e.jsx(tt,{})})]})]})},Ut=Ue(ot);export{Ut as default};
