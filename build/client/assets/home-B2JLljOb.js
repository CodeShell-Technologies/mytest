import{w as le}from"./with-props-DF0D9zIo.js";import{j as e,r as b}from"./chunk-AYJ5UCUI-nSEPIBkT.js";import{C as q,A as X,p as J,a as H,D as de,b as Z,L as Q,B as ne,c as ee,d as oe,P as ie,e as ce,i as xe,f as ge}from"./index-SUJt3Dgp.js";import{t as I}from"./bundle-mjs-BJOqOzcM.js";import{u as A}from"./AuthStore-BnYeBJES.js";import{a as $,B as O}from"./api-C04JdqFc.js";import{D as ae}from"./DrapDown-CEm3nLdF.js";import{u as te}from"./useBranchStore-kvv3vD_e.js";import{c as se}from"./index-DxoBGdjx.js";import{U as pe}from"./users-CXAhoVGa.js";import{C as W}from"./circle-check-big-DhDS6nah.js";import{C as me}from"./circle-x-Dr6D4A3M.js";import{B as V}from"./book-open-COuwv_wZ.js";import{C as Y}from"./circle-alert-CIGxBCHF.js";import{C as R}from"./clock-CzOQJT5p.js";import{P as ue}from"./ProgressCard-WzjzqIeA.js";import{e as be}from"./index-DTbJanog.js";import{D as he}from"./dollar-sign-D2IX7NrM.js";import{C as fe}from"./credit-card-YBFNOl8z.js";import{c as ye}from"./createLucideIcon-RccWoOaL.js";import{F as je}from"./file-text-BNGbNc3I.js";import"./react-_sXfQCJm.js";import"./iconBase-CajCgYY2.js";/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]],Ne=ye("trending-down",ve);q.register(X,J,H);const P=({data:r,className:i,theme:l="light"})=>{var s;const x={labels:r.labels||[],datasets:[{data:r.values||[],backgroundColor:r.colors||ke(((s=r.labels)==null?void 0:s.length)||0),borderColor:l==="dark"?"#1f2937":"#f9fafb",borderWidth:0,hoverOffset:10}]},v={responsive:!0,cutout:"50%",plugins:{legend:{position:"bottom",labels:{color:l==="dark"?"#d1d5db":"rgb(156 163 175)",padding:10,boxWidth:12,boxHeight:12,marging:20,font:{size:12,weight:"500",family:"Inter, sans-serif"}}},title:{display:!!r.title,text:r.title,color:l==="dark"?"#f3f4f6":" rgb(75 85 99)",font:{size:18,weight:"600",family:"Inter, sans-serif"},padding:{top:10,bottom:30}},tooltip:{backgroundColor:l==="dark"?"#1f2937":"#ffffff",titleColor:l==="dark"?"#e5e7eb":"#111827",bodyColor:l==="dark"?"#e5e7eb":"#111827",borderColor:l==="dark"?"#374151":"#e5e7eb",borderWidth:1,padding:8}}};return e.jsx("div",{className:I("w-full max-w-md mx-auto p-6 rounded-2xl border transition-all duration-300","shadow-md","dark:bg-gray-800 dark:border-gray-700 bg-white border-gray-200",i),children:e.jsx("div",{className:"w-full h-[600px]",children:e.jsx(de,{data:x,options:v})})})};function ke(r){const i=["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#ec4899","#14b8a6","#f97316","#6366f1","#d946ef","#0ea5e9","#84cc16"];return Array(r).fill(null).map((x,v)=>i[v%i.length])}q.register(Z,Q,ne,ee,J,H);const K=({data:r={},className:i,theme:l="light",title:x="Bar Chart",indexAxis:v="x",stacked:s=!1,showPercentage:m=!1,borderRadius:n=6,barPercentage:S=.5,categoryPercentage:B=.8})=>{var F;const k=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#14B8A6","#F97316","#6366F1","#D946EF"],_={labels:(r==null?void 0:r.labels)||[],datasets:((F=r==null?void 0:r.datasets)==null?void 0:F.map((g,j)=>({...g,label:g.label||`Dataset ${j+1}`,data:g.data||[],backgroundColor:g.backgroundColor||k[j%k.length],borderColor:g.borderColor||k[j%k.length],borderWidth:g.borderWidth||1,borderRadius:g.borderRadius||n,barPercentage:g.barPercentage||S,categoryPercentage:g.categoryPercentage||B})))||[]};if(_.labels.length===0||_.datasets.length===0)return e.jsx("div",{className:I("p-4 rounded-lg shadow-sm transition-all duration-300 flex items-center justify-center","dark:bg-gray-800 dark:border-gray-700 bg-white border border-gray-200",i),children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No data available"})});const L={indexAxis:v,responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{color:l==="dark"?"#e5e7eb":"#6b7280",font:{size:12,weight:"500"},usePointStyle:!0,pointStyle:"circle",padding:20}},title:{display:!!x,text:x,color:l==="dark"?"#f9fafb":"rgb(75 85 99)",font:{size:16,weight:"600"},padding:{top:10,bottom:20}},tooltip:{backgroundColor:l==="dark"?"#1f2937":"#ffffff",titleColor:l==="dark"?"#e5e7eb":"#111827",bodyColor:l==="dark"?"#e5e7eb":"#111827",borderColor:l==="dark"?"#374151":"#e5e7eb",borderWidth:1,padding:10,callbacks:{label:function(g){let j=g.dataset.label||"";return j&&(j+=": "),m?j+=g.raw+"%":j+=g.raw,j}}}},scales:{x:{stacked:s,grid:{display:!1,drawBorder:!1},ticks:{color:l==="dark"?"#9ca3af":"#6b7280"}},y:{stacked:s,grid:{color:l==="dark"?"rgba(229, 231, 235, 0.1)":"rgba(0,0,0,0.05)",drawBorder:!1},ticks:{color:l==="dark"?"#9ca3af":"#6b7280",callback:function(g){return m?g+"%":g}},beginAtZero:!0}}};return e.jsx("div",{className:I("p-4 rounded-lg shadow-sm transition-all duration-300","dark:bg-gray-800 dark:border-gray-700 bg-white border border-gray-200",i),children:e.jsx("div",{className:"h-[300px] w-full",children:e.jsx(oe,{data:_,options:L})})})};q.register(Z,Q,ie,ce,ee,J,H,xe);const we=({data:r,className:i,theme:l="light"})=>{const x={label:"Dataset",borderColor:"#3b82f6",backgroundColor:"rgba(59, 130, 246, 0.2)",borderWidth:2,pointRadius:3,pointHoverRadius:5,pointBackgroundColor:"#ffffff",pointBorderColor:function(m){return G(m.datasetIndex)},pointBorderWidth:2,tension:.4,fill:!1,cubicInterpolationMode:"monotone"},v={labels:r.labels||[],datasets:r.datasets.map((m,n)=>({...x,...m,borderColor:m.borderColor||G(n),backgroundColor:m.backgroundColor||`${G(n)}33`,tension:m.tension??x.tension}))},s={responsive:!0,maintainAspectRatio:!1,interaction:{intersect:!1,mode:"index"},plugins:{legend:{position:"top",labels:{color:l==="dark"?"#e5e7eb":"rgb(156 163 175)",font:{size:10,weight:"500"},padding:20,usePointStyle:!0,pointStyle:"circle"}},title:{display:!!r.title,text:r.title,color:"rgb(156 163 175)",font:{size:18,weight:"600"},padding:{top:10,bottom:20}},tooltip:{backgroundColor:l==="dark"?"#1f2937":"#ffffff",titleColor:l==="dark"?"#e5e7eb":"#111827",bodyColor:l==="dark"?"#e5e7eb":"#111827",borderColor:l==="dark"?"#374151":"#e5e7eb",borderWidth:1,padding:5,usePointStyle:!0,callbacks:{label:function(m){return`${m.dataset.label}: ${m.parsed.y}`}}}},scales:{x:{grid:{display:!1,drawBorder:!1},ticks:{color:l==="dark"?"#9ca3af":"#6b7280",font:{size:11}}},y:{grid:{color:l==="dark"?"rgba(229, 231, 235, 0.05)":"rgba(0, 0, 0, 0.05)",drawBorder:!1},ticks:{color:l==="dark"?"#9ca3af":"#6b7280",font:{size:11},padding:10}}},elements:{line:{borderJoinStyle:"round",capBezierPoints:!0}}};return e.jsx("div",{className:I("p-5 rounded-xl shadow-lg transition-all duration-300","dark:bg-gray-800 dark:border-gray-700 bg-white border-gray-200","border",i),children:e.jsx("div",{className:"h-[250px] w-full",children:e.jsx(ge,{data:v,options:s})})})};function G(r){const i=["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#ec4899","#14b8a6","#f97316","#6366f1","#d946ef","#0ea5e9","#84cc16"];return i[r%i.length]}q.register(X,J,H);const _e=()=>{const r=A(t=>t.accessToken),i=A(t=>t.role),l=A(t=>t.branchcode),[x,v]=b.useState(i==="superadmin"?"":l),[s,m]=b.useState(null),[n,S]=b.useState(null),[B,k]=b.useState(!1),[_,L]=b.useState(null),{branchCodeOptions:F,fetchBranches:g}=te();b.useEffect(()=>{i==="superadmin"&&g(r)},[r,i]),b.useEffect(()=>{x&&j()},[x]);const j=async()=>{k(!0);try{const t=await $.get(`${O}/report/attendancesummary/read?branchcode=${x}`,{headers:{Authorization:`Bearer ${r}`}});m(t.data.data);const u=await $.get(`${O}/users/leavereq/read?branchcode=${x}`,{headers:{Authorization:`Bearer ${r}`}});S(u.data.data)}catch(t){console.error("Error fetching data",t),L("Failed to fetch data"),se.error("Failed to fetch data")}finally{k(!1)}},U=()=>{if(!s)return null;const t=s.attendance_summary;return{overallData:{title:"Attendance Status",labels:["Present","Absent","On Leave","Waiting"],values:[t.present_count,t.absent_count,t.approved_leave_count,t.waitingforlogin_count],colors:["#10B981","#EF4444","#3B82F6","#F59E0B"]},leaveTypeData:{title:"Leave Types",labels:["Full Day","Half Day","Hourly"],values:[t.approved_leave_count-(t.half_day_leave_count+t.hourly_leave_count),t.half_day_leave_count,t.hourly_leave_count],colors:["#3B82F6","#8B5CF6","#EC4899"]},departmentData:{labels:s.department_counts.map(u=>u.department),datasets:[{label:"Present",data:s.department_counts.map(u=>u.present_count),backgroundColor:"#10B981"},{label:"Absent",data:s.department_counts.map(u=>u.absent_count),backgroundColor:"#EF4444"},{label:"On Leave",data:s.department_counts.map(u=>u.approved_leave_count),backgroundColor:"#3B82F6"},{label:"Waiting",data:s.department_counts.map(u=>u.waitingforlogin_count),backgroundColor:"#F59E0B"}]}}},M=()=>{if(!n)return null;const t=n.reduce((p,y)=>(p[y.leave_type]=(p[y.leave_type]||0)+1,p),{}),u=n.reduce((p,y)=>(p[y.status]=(p[y.status]||0)+1,p),{}),o=n.reduce((p,y)=>{const E=p.find(T=>T.staff_id===y.staff_id);return E?E.count+=1:p.push({name:y.staff_name,count:1,staff_id:y.staff_id}),p},[]).sort((p,y)=>y.count-p.count).slice(0,5);return{leaveTypeData:{title:"Leave Requests by Type",labels:Object.keys(t),values:Object.values(t),colors:["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6"]},leaveStatusData:{title:"Leave Requests by Status",labels:Object.keys(u),values:Object.values(u),colors:["#10B981","#F59E0B","#EF4444","#3B82F6"]},leaveByEmployee:{labels:o.map(p=>p.name),datasets:[{label:"Leave Requests",data:o.map(p=>p.count),backgroundColor:"#3B82F6"}]}}},h=U(),f=M();return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-[var(--color-primary)] dark:text-[var(--color-primary)]",children:"Branch Analytics Dashboard"}),i==="superadmin"&&e.jsx(ae,{options:F,selectedValue:x,onSelect:v,placeholder:"Select Branch",className:"w-[250px]"})]}),B&&e.jsx("div",{className:"text-center py-8",children:"Loading data..."}),_&&e.jsx("div",{className:"text-red-500 text-center py-8",children:_}),s&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Total Employees"}),e.jsx("p",{className:"text-2xl font-bold",children:s.total_employees})]}),e.jsx(pe,{className:"text-blue-500",size:24})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Present Today"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:s.attendance_summary.present_count})]}),e.jsx(W,{className:"text-green-500",size:24})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Absent Today"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:s.attendance_summary.absent_count})]}),e.jsx(me,{className:"text-red-500",size:24})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"On Leave"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:s.attendance_summary.approved_leave_count})]}),e.jsx(V,{className:"text-blue-500",size:24})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Waiting to Login"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:s.attendance_summary.waitingforlogin_count})]}),e.jsx(Y,{className:"text-yellow-500",size:24})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6",children:[(h==null?void 0:h.overallData)&&e.jsx("div",{className:" dark:bg-gray-800 p-4",children:e.jsx(P,{data:h.overallData,className:"h-[400px] w-full"})}),(h==null?void 0:h.leaveTypeData)&&e.jsx("div",{className:" dark:bg-gray-800 p-4 ",children:e.jsx(P,{data:h.leaveTypeData,className:"h-[400px] w-full"})}),(h==null?void 0:h.departmentData)&&e.jsx(K,{data:h.departmentData,title:"Department-wise Attendance",stacked:!0})]})]}),n&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Total Leave Requests"}),e.jsx("p",{className:"text-2xl font-bold",children:n.length})]}),e.jsx(V,{className:"text-blue-500",size:24})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Approved Leaves"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:n.filter(t=>t.status==="approved").length})]}),e.jsx(W,{className:"text-green-500",size:24})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Pending Leaves"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:n.filter(t=>t.status==="pending").length})]}),e.jsx(R,{className:"text-yellow-500",size:24})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6",children:[(f==null?void 0:f.leaveTypeData)&&e.jsx("div",{className:" dark:bg-gray-800 p-4 ",children:e.jsx(P,{data:f.leaveTypeData,className:"h-[400px] w-full"})}),(f==null?void 0:f.leaveByEmployee)&&e.jsx(K,{data:f.leaveByEmployee,title:"Top Employees by Leave Requests"}),(f==null?void 0:f.leaveStatusData)&&e.jsx("div",{className:" dark:bg-gray-800 p-4 ",children:e.jsx(P,{data:f.leaveStatusData,className:"h-[400px] w-full"})})]}),e.jsxs("div",{className:"mt-6 bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b dark:border-gray-700",children:e.jsx("h3",{className:"text-lg font-semibold",children:"Recent Leave Requests"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Employee"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Leave Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Dates"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Approved By"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:n.slice(0,5).map(t=>e.jsxs("tr",{children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:t.staff_name}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:t.staff_id})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300 capitalize",children:t.leave_type}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"text-sm text-gray-900 dark:text-gray-100",children:[new Date(t.start_date).toLocaleDateString()," -"," ",new Date(t.end_date).toLocaleDateString()]}),t.approved_dates&&e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Approved: ",t.approved_dates.join(", ")]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full 
                          ${t.status==="approved"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":t.status==="pending"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,children:t.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:t.approved_by_name||"-"})]},t.req_id))})]})})]})]}),!B&&!s&&e.jsx("div",{className:"text-center py-10 text-gray-500",children:x?"No data available for selected branch":"Please select a branch to view analytics"})]})},Ce=()=>{const r=A(a=>a.accessToken),i=A(a=>a.role),l=A(a=>a.branchcode),[x,v]=b.useState(i==="superadmin"?"":l),[s,m]=b.useState([]),[n,S]=b.useState([]),[B,k]=b.useState(!1),[_,L]=b.useState(null),{branchCodeOptions:F,fetchBranches:g}=te();b.useEffect(()=>{i==="superadmin"&&g(r)},[r,i]),b.useEffect(()=>{x&&j()},[x]);const j=async()=>{k(!0);try{const a=await $.get(`${O}/report/branchsummary/read?branchcode=${x}`,{headers:{Authorization:`Bearer ${r}`}});m(a.data.data);const d=await $.get(`${O}/project/invoice/read?branchcode=${x}`,{headers:{Authorization:`Bearer ${r}`}});S(d.data.data)}catch(a){console.error("Error fetching data",a),L("Failed to fetch data"),se.error("Failed to fetch data")}finally{k(!1)}},U=()=>{if(!n.length)return null;const a=n.reduce((w,C)=>w+parseFloat(C.invoice.final_amount),0),d=n.reduce((w,C)=>w+parseFloat(C.invoice.paid_amount),0),c=n.reduce((w,C)=>w+parseFloat(C.invoice.balance_amount),0),N=new Date,z=n.filter(w=>new Date(w.invoice.due_date)<N&&parseFloat(w.invoice.balance_amount)>0),D=z.reduce((w,C)=>w+parseFloat(C.invoice.balance_amount),0);return{totalAmount:a,paidAmount:d,balanceAmount:c,overdueCount:z.length,overdueAmount:D}},M=()=>s.length?s.map(a=>({clientName:a.client_name,totalAmount:parseFloat(a.total_client_amount),paidAmount:parseFloat(a.total_paid_amount),balanceAmount:parseFloat(a.total_balance_amount)})):null,h=()=>{if(!n.length)return null;const a=n.reduce((d,c)=>{const N=c.invoice.status;return d[N]=(d[N]||0)+1,d},{});return{title:"Invoice Status",labels:Object.keys(a).map(d=>d.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase())),values:Object.values(a),colors:["#10B981","#F59E0B","#EF4444","#3B82F6"]}},f=()=>{if(!n.length)return null;const a=n.reduce((c,N)=>{const z=new Date(N.invoice.invoice_date),D=`${z.getFullYear()}-${String(z.getMonth()+1).padStart(2,"0")}`;return c[D]?(c[D].paid+=parseFloat(N.invoice.paid_amount),c[D].pending+=parseFloat(N.invoice.balance_amount),c[D].total+=parseFloat(N.invoice.final_amount)):c[D]={paid:0,pending:parseFloat(N.invoice.balance_amount),total:parseFloat(N.invoice.final_amount)},c},{}),d=Object.keys(a).sort();return{title:"Payment Timeline",labels:d,datasets:[{label:"Paid",data:d.map(c=>a[c].paid),borderColor:"#10B981",backgroundColor:"rgba(16, 185, 129, 0.2)"},{label:"Pending",data:d.map(c=>a[c].pending),borderColor:"#F59E0B",backgroundColor:"rgba(245, 158, 11, 0.2)"},{label:"Total",data:d.map(c=>a[c].total),borderColor:"#3B82F6",backgroundColor:"rgba(59, 130, 246, 0.2)"}]}},t=()=>{if(!s.length)return null;const a=s.reduce((d,c)=>(d.draft+=parseInt(c.draft_projects),d.planning+=parseInt(c.planning_projects),d.inProcess+=parseInt(c.inprocess_projects),d.completed+=parseInt(c.completed_projects),d),{draft:0,planning:0,inProcess:0,completed:0});return{title:"Project Status",labels:["Draft","Planning","In Process","Completed"],values:[a.draft,a.planning,a.inProcess,a.completed],colors:["#F59E0B","#3B82F6","#8B5CF6","#10B981"]}},u=()=>s.length?{labels:s.map(a=>a.client_name),datasets:[{label:"Total Amount",data:s.map(a=>parseFloat(a.total_client_amount)),backgroundColor:"#3B82F6"},{label:"Paid Amount",data:s.map(a=>parseFloat(a.total_paid_amount)),backgroundColor:"#10B981"},{label:"Balance Amount",data:s.map(a=>parseFloat(a.total_balance_amount)),backgroundColor:"#F59E0B"}]}:null,o=U();M();const p=h(),y=f(),E=t(),T=u(),re=[{type:"paid",value:(o==null?void 0:o.paidAmount)||0,color:"bg-green-500",icon:e.jsx(W,{className:"text-green-500 mr-2"}),label:"Paid"},{type:"pending",value:(o==null?void 0:o.balanceAmount)||0,color:"bg-yellow-500",icon:e.jsx(R,{className:"text-yellow-500 mr-2"}),label:"Pending"},{type:"overdue",value:(o==null?void 0:o.overdueAmount)||0,color:"bg-red-500",icon:e.jsx(Y,{className:"text-red-500 mr-2"}),label:"Overdue"}];return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-[var(--color-primary)] dark:text-[var(--color-primary)]",children:"Accountant Dashboard"}),i==="superadmin"&&e.jsx(ae,{options:F,selectedValue:x,onSelect:v,placeholder:"Select Branch",className:"w-[250px]"})]}),B&&e.jsx("div",{className:"text-center py-8",children:"Loading data..."}),_&&e.jsx("div",{className:"text-red-500 text-center py-8",children:_}),s.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Total Revenue"}),e.jsxs("p",{className:"text-2xl font-bold",children:["â‚¹",o==null?void 0:o.totalAmount.toLocaleString()]})]}),e.jsx(he,{className:"text-blue-500",size:24})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Paid Amount"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["â‚¹",o==null?void 0:o.paidAmount.toLocaleString()]})]}),e.jsx(fe,{className:"text-green-500",size:24})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Pending Amount"}),e.jsxs("p",{className:"text-2xl font-bold text-yellow-600",children:["â‚¹",o==null?void 0:o.balanceAmount.toLocaleString()]})]}),e.jsx(Ne,{className:"text-yellow-500",size:24})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Overdue Amount"}),e.jsxs("p",{className:"text-2xl font-bold text-red-600",children:["â‚¹",o==null?void 0:o.overdueAmount.toLocaleString()]})]}),e.jsx(Y,{className:"text-red-500",size:24})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-15 mb-10 mt-10",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-tr-4xl rounded-bl-4xl shadow-lg overflow-hidden",children:[e.jsx("div",{className:"bg-red-800 dark:bg-red-800 px-5 py-2",children:e.jsx("h2",{className:"text-xl font-bold text-white",children:"Accounts Overview"})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex flex-col mb-4 p-3 bg-red-50 dark:bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsx(be,{className:"text-red-700 dark:text-red-800",size:20}),e.jsx("h3",{className:"text-lg font-medium text-gray-700 dark:text-gray-300",children:"Total Revenue"})]}),e.jsxs("p",{className:"text-xl font-bold text-red-700 dark:text-red-800",children:["â‚¹",o==null?void 0:o.totalAmount.toLocaleString()]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(je,{className:"text-green-600 dark:text-green-400",size:16}),e.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"Total Invoices"})]}),e.jsx("p",{className:"text-lg font-bold text-gray-800 dark:text-white",children:n.length})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(R,{className:"text-amber-600 dark:text-amber-400",size:16}),e.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"Pending Payments"})]}),e.jsx("p",{className:"text-lg font-bold text-gray-800 dark:text-white",children:n.filter(a=>parseFloat(a.invoice.balance_amount)>0).length})]})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-tr-4xl rounded-bl-4xl shadow-lg overflow-hidden",children:[e.jsx("div",{className:"bg-red-800 dark:bg-red-800 px-5 py-2 ",children:e.jsx("h2",{className:"text-xl font-bold text-white",children:"Projects Overview"})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex flex-col mb-4 p-3 bg-red-50 dark:bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsx(V,{className:"text-red-700 dark:text-red-800",size:20}),e.jsx("h3",{className:"text-lg font-medium text-gray-700 dark:text-gray-300",children:"Total Projects"})]}),e.jsx("p",{className:"text-xl font-bold text-red-700 dark:text-red-800",children:s.reduce((a,d)=>a+parseInt(d.total_projects),0)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(W,{className:"text-green-600 dark:text-green-400",size:16}),e.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"Completed"})]}),e.jsx("p",{className:"text-lg font-bold text-gray-800 dark:text-white",children:s.reduce((a,d)=>a+parseInt(d.completed_projects),0)})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(R,{className:"text-amber-600 dark:text-amber-400",size:16}),e.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"In Progress"})]}),e.jsx("p",{className:"text-lg font-bold text-gray-800 dark:text-white",children:s.reduce((a,d)=>a+parseInt(d.inprocess_projects),0)})]})]})]})]}),e.jsx("div",{className:"mt-10",children:e.jsx(ue,{items:re,title:"Payment Status",className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow "})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3 ",children:[p&&e.jsx("div",{className:" dark:bg-gray-800 p-4 ",children:e.jsx(P,{data:p,className:"h-[450px] w-full"})}),E&&e.jsx("div",{className:" dark:bg-gray-800 p-4 ",children:e.jsx(P,{data:E,className:"h-[450px] w-full"})}),y&&e.jsx("div",{className:" dark:bg-gray-800 p-4 ",children:e.jsx(we,{data:y,className:"h-[350px] w-full "})}),T&&e.jsx("div",{className:" dark:bg-gray-800 p-4 ",children:e.jsx(K,{data:T,title:"Client-wise Payments",className:"h-[350px] w-full"})})]}),e.jsxs("div",{className:"mt-6 bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b dark:border-gray-700",children:e.jsx("h3",{className:"text-lg font-semibold",children:"Recent Invoices"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Invoice No"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Client"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Project"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Paid"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Balance"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Due Date"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:n.slice(0,5).map(a=>e.jsxs("tr",{children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:a.invoice.invoice_no}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:new Date(a.invoice.invoice_date).toLocaleDateString()})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:a.invoice.client_name}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:a.invoice.company_name})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:a.invoice.project_title}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-gray-100",children:["â‚¹",parseFloat(a.invoice.final_amount).toLocaleString()]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-green-600",children:["â‚¹",parseFloat(a.invoice.paid_amount).toLocaleString()]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-yellow-600",children:["â‚¹",parseFloat(a.invoice.balance_amount).toLocaleString()]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full 
                          ${a.invoice.status==="paid"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":a.invoice.status==="pending"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,children:a.invoice.status.replace(/_/g," ").replace(/\b\w/g,d=>d.toUpperCase())})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:`text-sm ${new Date(a.invoice.due_date)<new Date&&parseFloat(a.invoice.balance_amount)>0?"text-red-600 font-medium":"text-gray-500 dark:text-gray-300"}`,children:new Date(a.invoice.due_date).toLocaleDateString()})})]},a.invoice.invoice_id))})]})})]})]}),!B&&s.length===0&&e.jsx("div",{className:"text-center py-10 text-gray-500",children:x?"No data available for selected branch":"Please select a branch to view analytics"})]})},Be=()=>{const[r,i]=b.useState([{id:1,date:"15 Jun",status:"ðŸŸ¢",message:"Payroll processed for June (â‚¹8.42L)",isNew:!0,read:!1},{id:2,date:"15 Jun",status:"ðŸ“„",message:"Payroll processed for June (â‚¹8.42L)",isNew:!1,read:!0},{id:3,date:"15 Jun",status:"ðŸŸ ",message:"Payroll processed for June (â‚¹8.42L)",isNew:!0,read:!1}]);return e.jsxs(e.Fragment,{children:[e.jsx(_e,{}),e.jsx(Ce,{})]})},Xe=le(Be);export{Xe as default};
