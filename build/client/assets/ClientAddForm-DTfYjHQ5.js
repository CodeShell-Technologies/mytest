import{w as U}from"./with-props-DF0D9zIo.js";import{r as o,j as e}from"./chunk-AYJ5UCUI-nSEPIBkT.js";import{t as H,a as w,B as _}from"./api-C04JdqFc.js";import{O as V,V as p}from"./index-DxoBGdjx.js";import{B as W}from"./ButtonLoader-Z62NVHwI.js";import{u as y}from"./AuthStore-BnYeBJES.js";import{u as G}from"./useBranchStore-kvv3vD_e.js";import"./LeadsStore-C-d0npQs.js";import{U as b}from"./user-DKFoNGWn.js";import{H as z}from"./hash-Cmnw3-GM.js";import{P as A,M as q}from"./phone-iHDF8fYQ.js";import{C as g}from"./clipboard-list-C2ET-QCv.js";import{F as J}from"./file-text-BNGbNc3I.js";import{M as K}from"./map-pin-DetA7opX.js";import{T as Q}from"./trash-2-AUNIB88j.js";import{P as X}from"./plus-HifIQSWH.js";import"./react-_sXfQCJm.js";import"./createLucideIcon-RccWoOaL.js";const Y=({onSuccess:L,onCancel:h})=>{const[u,f]=o.useState(!1),[S,E]=o.useState(null),k=y(a=>a.accessToken),P=y(a=>a.permissions)[0].role,B=G(a=>a.branchCodeOptions),j=y(a=>a.branchcode),[v,c]=o.useState([]),[N,C]=o.useState(!1),x=P==="superadmin"?B:[{value:j,label:j}],[r,i]=o.useState({branchcode:"",lead_id:"",client_name:"",company_name:"",primary_phone:"",email:"",office_address:"",website:"",industry_type:"commercial",comm_type:"email",status:"active",contacts:[{name:"",designation:"",phone:"",email:""}]}),O=[{value:"commercial",label:"Commercial"},{value:"residential",label:"Residential"},{value:"industrial",label:"Industrial"},{value:"retail",label:"Retail"},{value:"hospitality",label:"Hospitality"}],F=[{value:"email",label:"Email"},{value:"call",label:"Call"},{value:"mom",label:"Meeting"},{value:"all",label:"All"},{value:"none",label:"None"}],D=[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"blacklisted",label:"Blacklisted"}],I=async a=>{var s;if(!a){c([]);return}C(!0);try{const t=await w.get(`${_}/campaign/leads/read?branchcode=${a}&limit=1000`,{headers:{Authorization:`Bearer ${k}`}});if((s=t.data)!=null&&s.data){const l=t.data.data.map(n=>({value:n.id,label:n.lead_name||n.name||"Unnamed Lead"}));c(l)}else c([])}catch(t){console.error("Error fetching lead options",t),p.error("Failed to fetch leads"),c([])}finally{C(!1)}};o.useEffect(()=>{r.branchcode?I(r.branchcode):(c([]),i(a=>({...a,lead_id:""})))},[r.branchcode]);const d=a=>{const{name:s,value:t}=a.target;if(i(l=>({...l,[s]:t})),s==="lead_id"&&t){const l=v.find(n=>n.value===t);l&&i(n=>({...n,client_name:l.label}))}},m=(a,s)=>{const{name:t,value:l}=s.target,n=[...r.contacts];n[a]={...n[a],[t]:l},i(M=>({...M,contacts:n}))},R=()=>{i(a=>({...a,contacts:[...a.contacts,{name:"",designation:"",phone:"",email:""}]}))},T=a=>{if(r.contacts.length===1)return;const s=r.contacts.filter((t,l)=>l!==a);i(t=>({...t,contacts:s}))},$=async a=>{var t,l;a.preventDefault(),f(!0);const s={data:[{branchcode:r.branchcode,lead_id:r.lead_id,company_name:r.company_name,client_name:r.client_name,primary_phone:r.primary_phone,email:r.email,office_address:r.office_address,website:r.website,contacts:r.contacts,industry_type:r.industry_type,comm_type:r.comm_type,status:r.status}]};try{(await w.post(`${_}/client/overview/create`,s,{headers:{Authorization:`Bearer ${k}`}})).status===201?(p.success("New Client Added Successfully!"),h(),L()):console.error("Error in create")}catch(n){E(((l=(t=n.response)==null?void 0:t.data)==null?void 0:l.message)||"An error occurred"),p.error(S||"Error creating client")}finally{f(!1)}};return e.jsxs("div",{className:"flex flex-col gap-6 dark:bg-gray-800 bg-white p-6 rounded-lg",children:[e.jsx(V,{position:H}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold border-b pb-2 text-gray-800 dark:text-gray-100 border-gray-200 dark:border-gray-700",children:"Client Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(b,{className:"inline mr-1",size:14})," Client Name"]}),e.jsx("input",{name:"client_name",value:r.client_name,onChange:d,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",type:"text",placeholder:"Client Name",required:!0})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(z,{className:"inline mr-1",size:14})," Branch Code"]}),e.jsxs("select",{name:"branchcode",value:r.branchcode,onChange:d,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",required:!0,children:[e.jsx("option",{value:"",children:"Select Branch"}),x==null?void 0:x.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(z,{className:"inline mr-1",size:14})," Company Name"]}),e.jsx("input",{name:"company_name",value:r.company_name,onChange:d,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",type:"text",placeholder:"Company Name",required:!0})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(A,{className:"inline mr-1",size:14})," Primary Phone"]}),e.jsx("input",{name:"primary_phone",value:r.primary_phone,onChange:d,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",type:"text",placeholder:"Primary Phone",required:!0})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(q,{className:"inline mr-1",size:14})," Email"]}),e.jsx("input",{name:"email",value:r.email,onChange:d,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",type:"email",placeholder:"Email",required:!0})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(g,{className:"inline mr-1",size:14})," Industry Type"]}),e.jsx("select",{name:"industry_type",value:r.industry_type,onChange:d,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",required:!0,children:O.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(J,{className:"inline mr-1",size:14})," Website"]}),e.jsx("input",{name:"website",value:r.website,onChange:d,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",type:"text",placeholder:"Website URL"})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(g,{className:"inline mr-1",size:14})," Lead"]}),e.jsxs("select",{name:"lead_id",value:r.lead_id,onChange:d,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",disabled:!r.branchcode||N,required:!0,children:[e.jsx("option",{value:"",children:"Select Lead"}),N?e.jsx("option",{value:"",disabled:!0,children:"Loading leads..."}):v.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold border-b pb-2 text-gray-800 dark:text-gray-100 border-gray-200 dark:border-gray-700",children:"Address Information"}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2",children:[e.jsx(K,{className:"inline mr-1",size:14})," Office Address"]}),e.jsx("textarea",{name:"office_address",value:r.office_address,onChange:d,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 focus:outline-none min-h-[80px]",placeholder:"Office Address",required:!0})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold border-b pb-2 text-gray-800 dark:text-gray-100 border-gray-200 dark:border-gray-700",children:"Contacts"}),r.contacts.map((a,s)=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 relative",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(b,{className:"inline mr-1",size:14})," Contact Name"]}),e.jsx("input",{name:"name",value:a.name,onChange:t=>m(s,t),className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",type:"text",placeholder:"Contact Name",required:!0})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(b,{className:"inline mr-1",size:14})," Designation"]}),e.jsx("input",{name:"designation",value:a.designation,onChange:t=>m(s,t),className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",type:"text",placeholder:"Designation",required:!0})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(A,{className:"inline mr-1",size:14})," Phone"]}),e.jsx("input",{name:"phone",value:a.phone,onChange:t=>m(s,t),className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",type:"text",placeholder:"Phone",required:!0})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(q,{className:"inline mr-1",size:14})," Email"]}),e.jsx("input",{name:"email",value:a.email,onChange:t=>m(s,t),className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",type:"email",placeholder:"Email",required:!0})]}),s>0&&e.jsx("button",{type:"button",onClick:()=>T(s),className:"absolute -right-2 -top-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 transition-colors",children:e.jsx(Q,{size:16})})]},s)),e.jsxs("button",{type:"button",onClick:R,className:"flex items-center gap-1 text-sm text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300",children:[e.jsx(X,{size:16})," Add Another Contact"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold border-b pb-2 text-gray-800 dark:text-gray-100 border-gray-200 dark:border-gray-700",children:"Communication & Status"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(g,{className:"inline mr-1",size:14})," Communication Type"]}),e.jsx("select",{name:"comm_type",value:r.comm_type,onChange:d,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",required:!0,children:F.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(g,{className:"inline mr-1",size:14})," Status"]}),e.jsx("select",{name:"status",value:r.status,onChange:d,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",required:!0,children:D.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("button",{type:"button",className:"px-5 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 rounded-md transition-colors duration-200 font-medium text-sm",onClick:h,disabled:u,children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-5 py-2 bg-red-700 hover:bg-red-800 dark:bg-red-700 dark:hover:bg-red-800 text-white rounded-md transition-colors duration-200 font-medium text-sm shadow-sm",onClick:$,disabled:u,children:u?e.jsx(W,{}):"Create Client"})]})]})},he=U(Y);export{he as default};
