import{r as d,j as e}from"./chunk-AYJ5UCUI-nSEPIBkT.js";import{a as b,B as j,t as T}from"./api-C04JdqFc.js";import{V as m,O as U}from"./index-DxoBGdjx.js";import{B as H}from"./ButtonLoader-Z62NVHwI.js";import{u as f}from"./AuthStore-BnYeBJES.js";import{u as V}from"./UseStaffFilter-Bwbq-nCs.js";import{u as G}from"./useBranchStore-kvv3vD_e.js";import{B as J}from"./book-user-BTUNghSh.js";import{H as K}from"./hash-Cmnw3-GM.js";import{B as Q}from"./briefcase-B0VTTUxq.js";import{N as P}from"./network-4iL8t-Of.js";import{c as W}from"./createLucideIcon-RccWoOaL.js";import{C as q}from"./calendar-check-DuYbAMAv.js";import{B as X}from"./building-38OCE1f9.js";import{U as Y}from"./user-DKFoNGWn.js";import{T as v}from"./tag-hjf6KM-t.js";import{B as Z}from"./book-open-text-CwD5ICOx.js";/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],re=W("map",ee),ke=({onSuccess:D,onCancel:A})=>{const[g,k]=d.useState(!1),[E,N]=d.useState(null),u=f(r=>r.accessToken),[ae,i]=d.useState([]),[x,l]=d.useState([]),[te,w]=d.useState(!1),[C,_]=d.useState(!1),F=f(r=>r.permissions)[0].role,O=G(r=>r.branchCodeOptions),S=f(r=>r.branchcode),p=F==="superadmin"?O:[{value:S,label:S}],[a,B]=d.useState({branchcode:"",client_code:"",project_code:"",title:"",priority:"",type:"",loc:"",start_date:"",end_date:"",handler_by:"",notes:"",status:"draft"}),{departmentOptions:L,selectedDepartment:y,staffOptions:h,isFetchingStaff:z,handleDepartmentChange:$}=V(a.branchcode);d.useEffect(()=>{a.branchcode?(M(a.branchcode),I(a.branchcode)):(i([]),l([]))},[a.branchcode]);const M=async r=>{w(!0);try{const t=await b.get(`${j}/campaign/overview/dropdown?branchcode=${r}`,{headers:{Authorization:`Bearer ${u}`}});if(t.data&&t.data.data){const o=t.data.data.map(n=>({value:n.campaign_code,label:n.campaignname}));i(o)}else i([])}catch{m.error("Failed to fetch campaign options"),i([])}finally{w(!1)}},I=async r=>{_(!0);try{const t=await b.get(`${j}/client/overview/dropdown?branchcode=${r}`,{headers:{Authorization:`Bearer ${u}`}});if(t.data&&t.data.data){const o=t.data.data.map(n=>({value:n.client_code,label:n.client_name}));l(o)}else l([])}catch{m.error("Failed to fetch client options"),l([])}finally{_(!1)}},s=r=>{const{name:t,value:o}=r.target;B(n=>({...n,[t]:o}))},R=async r=>{var o,n;r.preventDefault(),k(!0);const t={data:{branchcode:a.branchcode,client_code:a.client_code,project_code:a.project_code,title:a.title,priority:a.priority,type:a.type,loc:a.loc,start_date:a.start_date,end_date:a.end_date,handler_by:a.handler_by,notes:a.notes,status:a.status}};try{const c=await b.post(`${j}/project/overview/create`,t,{headers:{Authorization:`Bearer ${u}`}});c.status===201?(m.success("Project created successfully!"),D()):N(c.data.message||"Failed to create project")}catch(c){N(((n=(o=c.response)==null?void 0:o.data)==null?void 0:n.message)||"An error occurred"),m.error(E||"Error creating project")}finally{k(!1)}};return e.jsxs("div",{className:"flex flex-col gap-6 dark:bg-gray-800 bg-white p-6 rounded-lg",children:[e.jsx(U,{position:T}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold border-b pb-2 text-gray-800 dark:text-gray-100 border-gray-200 dark:border-gray-700",children:[e.jsx(J,{className:"inline mr-2"})," Project Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(K,{className:"inline mr-1",size:14})," Branch Code"]}),e.jsxs("select",{name:"branchcode",value:a.branchcode,onChange:s,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",required:!0,children:[e.jsx("option",{value:"",children:"Select Branch"}),p==null?void 0:p.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(Q,{className:"inline mr-1",size:14})," Client Code"]}),C?e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:"Loading clients..."}):e.jsxs("select",{name:"client_code",value:a.client_code,onChange:s,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",required:!0,disabled:!a.branchcode||x.length===0,children:[e.jsx("option",{value:"",children:"Select Client"}),x.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))]}),a.branchcode&&x.length===0&&!C&&e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"No clients found for this branch"})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(P,{className:"inline mr-1",size:14})," Project Codes"]}),e.jsx("input",{name:"project_code",value:a.project_code,onChange:s,type:"text",className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",placeholder:"Enter Project Name",required:!0})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(P,{className:"inline mr-1",size:14})," Project Name"]}),e.jsx("input",{name:"title",value:a.title,onChange:s,type:"text",className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",placeholder:"Enter Project Name",required:!0})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(re,{className:"inline mr-1",size:14})," Location"]}),e.jsx("input",{name:"loc",value:a.loc,onChange:s,type:"text",className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",placeholder:"Enter Location",required:!0})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(q,{className:"inline mr-1",size:14})," Start Date"]}),e.jsx("input",{name:"start_date",value:a.start_date,onChange:s,type:"date",className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",required:!0})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(q,{className:"inline mr-1",size:14})," End Date"]}),e.jsx("input",{name:"end_date",value:a.end_date,onChange:s,type:"date",className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",required:!0})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(X,{className:"inline mr-1",size:14})," Department"]}),e.jsxs("select",{value:y,onChange:r=>{$(r.target.value),B(t=>({...t,handler_by:"",handler_to:""}))},className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",required:!0,children:[e.jsx("option",{value:"",children:"Select Department"}),L.map(r=>e.jsx("option",{value:r,children:r},r))]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(Y,{className:"inline mr-1",size:14})," Handler By"]}),z?e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:"Loading staff..."}):e.jsxs("select",{name:"handler_by",value:a.handler_by,onChange:s,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",required:!0,disabled:!y||h.length===0,children:[e.jsx("option",{value:"",children:"Select Staff"}),h.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))]}),y&&h.length===0&&!z&&e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"No staff found in this department"})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(v,{className:"inline mr-1",size:14})," Priority"]}),e.jsxs("select",{name:"priority",value:a.priority,onChange:s,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",required:!0,children:[e.jsx("option",{value:"",children:"Select priority"}),e.jsx("option",{value:"minor",children:"Minor"}),e.jsx("option",{value:"major",children:"Major"}),e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"blocker",children:"Blocker"})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold border-b pb-2 text-gray-800 dark:text-gray-100 border-gray-200 dark:border-gray-700",children:"Project & Status"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(v,{className:"inline mr-1",size:14})," Project Type"]}),e.jsxs("select",{name:"type",value:a.type,onChange:s,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",required:!0,children:[e.jsx("option",{value:"",children:"Select type"}),e.jsx("option",{value:"residential",children:"Residential"}),e.jsx("option",{value:"commercial",children:"Commercial"}),e.jsx("option",{value:"industrial",children:"Industrial"}),e.jsx("option",{value:"land",children:"Land"})]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(v,{className:"inline mr-1",size:14})," Status"]}),e.jsxs("select",{name:"status",value:a.status,onChange:s,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",required:!0,children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"planning",children:"Planning"}),e.jsx("option",{value:"inprocess",children:"In Progress"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"lead_review",children:"Lead Review"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"revised",children:"Revised"}),e.jsx("option",{value:"client_review",children:"Client_review"}),e.jsx("option",{value:"drop",children:"Drop"})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold border-b pb-2 text-gray-800 dark:text-gray-100 border-gray-200 dark:border-gray-700",children:[e.jsx(Z,{className:"inline mr-2"})," Notes & Summary"]}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:e.jsx("textarea",{name:"notes",value:a.notes,onChange:s,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 focus:outline-none min-h-[100px]",placeholder:"Enter project notes and summary..."})})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("button",{type:"button",className:"px-5 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 rounded-md transition-colors duration-200 font-medium text-sm",onClick:A,disabled:g,children:"Cancel"}),e.jsx("button",{type:"submit",onClick:R,className:"px-5 py-2 bg-red-700 hover:bg-red-800 dark:bg-red-800 dark:hover:bg-red-900 text-white rounded-md transition-colors duration-200 font-medium text-sm shadow-sm",disabled:g,children:g?e.jsx(H,{}):"Create Project"})]})]})};export{ke as A,re as M};
