import{w as fe}from"./with-props-DF0D9zIo.js";import{r as a,j as e}from"./chunk-AYJ5UCUI-nSEPIBkT.js";import{D as ge}from"./DataTable-DtyPIAGZ.js";import{C as be}from"./CustomPagination-CBTcVvJz.js";import{S as Se}from"./SearchInput-CMdOUuSO.js";import{M as N}from"./Modal-BCIUwH-b.js";import{D as _}from"./DrapDown-CEm3nLdF.js";import{F as ye,u as C,w as we}from"./xlsx-DTxMWUdD.js";import{t as je,B as z,a as A}from"./api-C04JdqFc.js";import{C as ve}from"./CreateBranchForm-2rtCEtUt.js";import{O as Ne,V as x}from"./index-DxoBGdjx.js";import{E as Ce}from"./EditFormData-Bo3BQ7HJ.js";import{B as Be}from"./ButtonLoader-Z62NVHwI.js";import{u as ke}from"./AuthStore-BnYeBJES.js";import{u as $e}from"./useBranchStore-kvv3vD_e.js";import{u as De}from"./use-click-outside-BhLpsQYS.js";import"./index-knF4tUPh.js";/* empty css            */import"./index-DDa5wjlm.js";import"./iconBase-CajCgYY2.js";import"./createLucideIcon-RccWoOaL.js";import"./useEmployeeStore-BJ_SZO4g.js";/* empty css                         */import"./moment-C5S46NFB.js";import"./react-_sXfQCJm.js";import"./network-4iL8t-Of.js";import"./hash-Cmnw3-GM.js";import"./calendar-check-DuYbAMAv.js";import"./map-pin-DetA7opX.js";import"./phone-iHDF8fYQ.js";import"./user-round-DtkRnRSi.js";import"./user-DKFoNGWn.js";import"./clipboard-list-C2ET-QCv.js";import"./file-text-BNGbNc3I.js";const Ee=()=>{const r=De({query:"(max-width: 768px)"}),[f,V]=a.useState(""),[g,n]=a.useState(1),[Le,Fe]=a.useState(""),[T,R]=a.useState([]),[B,Me]=a.useState(""),[k,U]=a.useState([]),[i,m]=a.useState(!1),[q,G]=a.useState(0),[$,H]=a.useState(null),[K,b]=a.useState(!1),[Q,S]=a.useState(!1),[J,Oe]=a.useState(),[W,y]=a.useState(!1),[X,Ie]=a.useState(""),[w,Y]=a.useState(""),[D,Pe]=a.useState(""),[j,Z]=a.useState(""),[u,ee]=a.useState(8),[v,te]=a.useState(!1),c=ke(t=>t.accessToken),{branches:_e,managerOptions:ze,branchCodeOptions:ae,fetchBranches:h,isLoading:se}=$e(),re=[{value:20,label:"20 per page"},{value:40,label:"30 per page"},{value:50,label:"40 per page"},{value:80,label:"50 per page"},{value:100,label:"100 per page"},{value:200,label:"100 per page"}];a.useEffect(()=>{h(c)},[c]);const p=async(t=g,d=u,o=f,E=B,L=D,F=j,M=w)=>{var O,I,P;m(!0);try{let l=`${z}/users/login/read?page=${t}&limit=${d}`;o&&(l+=`&search=${o}`),E&&(l+=`&status=${E}`),L&&(l+=`&manager_id=${L}`),F&&(l+=`&branchcode=${F}`),M&&(l+=`&dec=${M}`);const s=await A.get(l,{headers:{Authorization:`Bearer ${c}`}});R((O=s==null?void 0:s.data)==null?void 0:O.data),G(((I=s==null?void 0:s.data)==null?void 0:I.totalDocuments)||0),U(((P=s==null?void 0:s.data)==null?void 0:P.data)||[])}catch(l){console.error("Error fetching branch list",l),H("Failed to fetch branches")}finally{m(!1)}};a.useEffect(()=>{p()},[g,f,B,D,j,w,u]);const oe=t=>{n(t)},le=()=>{b(!1),x.success("Branch added successfully!"),h(c),p()},ce=t=>{V(t),n(1)},ne=async()=>{const t=Number(X),d={userId:"GK123"};try{m(!0);const o=await A.delete(`${z}/branch/delete/${t}`,{data:d,headers:{Authorization:`Bearer ${c}`}});(o==null?void 0:o.status)===201&&(y(!1),x.success("Branch deleted successfully!"),h(c),p())}catch(o){console.error("Error deleting branch",o),x.error("Failed to delete branch")}finally{m(!1)}},de=()=>{Y(t=>t==="desc"?"":"desc"),n(1)},ie=t=>{Z(t),n(1)},me=t=>{ee(t),n(1)},ue=()=>[{data:"id"},{data:"Branch Code"},{data:"name"},{data:"Location"},{data:"Mobile"},{data:"Manager ID"},{data:"Status"}],he=()=>k?k.map(t=>({id:t.id,data:[{data:t.id},{data:t.branchcode},{data:t.staff_id},{data:t.date},{data:t.time},{data:t.ip},{data:t.device}]})):[],pe=()=>{S(!1),x.success("Branch updated successfully!"),h(c),p()},xe=()=>{const t=C.book_new(),d=C.json_to_sheet(T);C.book_append_sheet(t,d,"Branches"),we(t,"BranchList.xlsx")};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col min-h-screen",children:[e.jsxs("div",{className:"p-4 flex-grow",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-[var(--color-primary)] dark:text-[var(--color-primary)]",children:"User Login Logs"}),r&&e.jsx("button",{onClick:()=>te(!v),className:"p-2 bg-gray-200 rounded-md",children:v?"Hide Filters":"Show Filters"})]}),e.jsx(Ne,{position:je,reverseOrder:!1}),e.jsx("div",{className:`flex ${r?"flex-col":"items-end justify-end"} gap-4 mb-5`,children:e.jsxs("div",{className:`flex ${r?"flex-col":"flex-row"} gap-4`,children:[e.jsx(_,{options:re,selectedValue:u,onSelect:me,placeholder:"Items per page",className:"w-full md:w-[150px]"}),e.jsxs("button",{onClick:xe,className:"flex items-center justify-center text-gray-400 bg-white focus:outline-non font-medium text-sm rounded-sm border border-dotted border-gray-400 hover:text-red-700/70 px-3 dark:bg-gray-800 dark:text-gray-300 py-2.5",children:[e.jsx(ye,{className:"mr-1"}),!r&&"Export Excel"]})]})}),e.jsx("div",{className:`${r&&!v?"hidden":"block"} mb-4`,children:e.jsxs("div",{className:`${r?"grid grid-cols-1 gap-3":"flex flex-wrap justify-between items-center gap-3"}`,children:[e.jsx(_,{options:ae,selectedValue:j,onSelect:ie,placeholder:"Branch Code",className:"w-full md:w-[200px]",isLoading:se}),e.jsxs("button",{onClick:de,className:`${r?"w-full":"w-[200px]"} h-[40px] text-white bg-[var(--color-primary)] hover-effect px-2 py-1 rounded-sm`,children:["Sort ",w==="desc"?"↑":"↓"]}),e.jsx("div",{className:`${r?"w-full":"w-[200px] mt-3"}`,children:e.jsx(Se,{value:f,onChange:ce,placeholder:"Search Logs...",className:"w-full"})})]})}),i&&e.jsx("div",{className:"text-center py-4",children:"Loading..."}),$&&e.jsx("div",{className:"text-red-500 text-center py-4",children:$}),e.jsx("div",{className:"overflow-x-auto",children:e.jsx(ge,{thead:ue,tbody:he,responsive:!0,className:"min-w-full"})})]}),e.jsx("div",{className:"bottom-0 border-t border-gray-200 dark:border-gray-700 p-4",children:e.jsx(be,{total:q,currentPage:g,defaultPageSize:u,onChange:oe,paginationLabel:"branches",isScroll:!0})})]}),e.jsx(N,{isVisible:K,className:"w-full md:w-[800px]",onClose:()=>b(!1),title:"Create New Branch",children:e.jsx(ve,{onSuccess:le,onCancel:()=>b(!1)})}),e.jsx(N,{isVisible:Q,className:"w-full md:w-[800px]",onClose:()=>S(!1),title:"Edit Branch",children:e.jsx(Ce,{branch:J,onSuccess:pe,onCancel:()=>S(!1)})}),e.jsx(N,{isVisible:W,className:"w-full md:w-[600px]",onClose:()=>y(!1),title:"Delete Branch",children:e.jsxs("div",{className:"flex flex-col gap-6 dark:bg-gray-800 bg-white p-6 rounded-lg",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-100",children:"Confirm Deletion"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Are you sure you want to delete this branch? This action cannot be undone."})]}),e.jsxs("div",{className:"flex justify-center gap-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("button",{type:"button",className:"px-5 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 rounded-md transition-colors duration-200 font-medium text-sm",onClick:()=>y(!1),disabled:i,children:"Cancel"}),e.jsx("button",{type:"button",className:"px-5 py-2 bg-red-700 hover:bg-red-800 dark:bg-red-700 dark:hover:bg-red-800 text-white rounded-md transition-colors duration-200 font-medium text-sm shadow-sm",onClick:ne,disabled:i,children:i?e.jsx(Be,{}):"Delete Branhch"})]})]})})]})},St=fe(Ee);export{St as default};
