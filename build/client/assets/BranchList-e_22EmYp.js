import{w as Be}from"./with-props-DF0D9zIo.js";import{r as a,j as e,b as ke}from"./chunk-AYJ5UCUI-nSEPIBkT.js";import{D as Me}from"./DataTable-DtyPIAGZ.js";import{C as $e}from"./CustomPagination-CBTcVvJz.js";import{S as Ee}from"./SearchInput-CMdOUuSO.js";import{M as b}from"./Modal-BCIUwH-b.js";import{D as S}from"./DrapDown-CEm3nLdF.js";import{F as De,u as $,w as Fe}from"./xlsx-DTxMWUdD.js";import{t as Le,B as R,a as q}from"./api-C04JdqFc.js";import{C as Oe}from"./CreateBranchForm-2rtCEtUt.js";import{O as Ve,V as d}from"./index-DxoBGdjx.js";import{E as ze}from"./EditFormData-Bo3BQ7HJ.js";import{B as Ae}from"./ButtonLoader-Z62NVHwI.js";import{u as Ie}from"./AuthStore-BnYeBJES.js";import{u as Pe}from"./useBranchStore-kvv3vD_e.js";import{u as Te}from"./use-click-outside-BhLpsQYS.js";import{B as _e}from"./BranchMeetingForm-DfT3S_5L.js";import{M as Re}from"./message-square-text-D3my64cM.js";import{E as qe}from"./eye-2Mk8PZw-.js";import"./index-knF4tUPh.js";/* empty css            */import"./index-DDa5wjlm.js";import"./iconBase-CajCgYY2.js";import"./createLucideIcon-RccWoOaL.js";import"./useEmployeeStore-BJ_SZO4g.js";/* empty css                         */import"./moment-C5S46NFB.js";import"./react-_sXfQCJm.js";import"./network-4iL8t-Of.js";import"./hash-Cmnw3-GM.js";import"./calendar-check-DuYbAMAv.js";import"./map-pin-DetA7opX.js";import"./phone-iHDF8fYQ.js";import"./user-round-DtkRnRSi.js";import"./user-DKFoNGWn.js";import"./clipboard-list-C2ET-QCv.js";import"./file-text-BNGbNc3I.js";import"./video-BzePKQuD.js";import"./file-QxKA-9Fo.js";import"./calendar-C_LRGMui.js";import"./clock-CzOQJT5p.js";import"./users-CXAhoVGa.js";import"./x-BfrbTbzo.js";import"./chevron-up-DjUqBI0v.js";import"./chevron-down-DOBgonSl.js";import"./plus-HifIQSWH.js";const Ge=()=>{const r=Te({query:"(max-width: 768px)"}),[w,G]=a.useState(""),[y,n]=a.useState(1),[He,Ke]=a.useState(""),[H,K]=a.useState([]),[j,Q]=a.useState(""),[E,U]=a.useState([]),[m,u]=a.useState(!1),[J,W]=a.useState(0),[D,X]=a.useState(null),[Y,h]=a.useState(!1),[Z,v]=a.useState(!1),[F,Qe]=a.useState(),[ee,N]=a.useState(!1),[te,Ue]=a.useState(""),[C,ae]=a.useState(""),[B,se]=a.useState(""),[k,re]=a.useState(""),[p,oe]=a.useState(8),[M,le]=a.useState(!1),c=Ie(t=>t.accessToken),[ne,x]=a.useState(!1),{branches:Je,managerOptions:ce,branchCodeOptions:ie,fetchBranches:f,isLoading:L}=Pe(),de=[{value:"",label:"All Branches"},{value:"active",label:"Active Branches"},{value:"inactive",label:"Inactive Branches"}],me=[{value:20,label:"20 per page"},{value:40,label:"30 per page"},{value:50,label:"40 per page"},{value:80,label:"50 per page"},{value:100,label:"100 per page"},{value:200,label:"100 per page"}];a.useEffect(()=>{f(c)},[c]);const g=async(t=y,i=p,o=w,O=j,V=B,z=k,A=C)=>{var I,P,T,_;u(!0);try{let l=`${R}/branch/admin?role=admin&page=${t}&limit=${i}`;o&&(l+=`&search=${o}`),O&&(l+=`&status=${O}`),V&&(l+=`&manager_id=${V}`),z&&(l+=`&branchcode=${z}`),A&&(l+=`&dec=${A}`);const s=await q.get(l,{headers:{Authorization:`Bearer ${c}`}});console.log("responseeebranch",(I=s==null?void 0:s.data)==null?void 0:I.result),K((P=s==null?void 0:s.data)==null?void 0:P.result),W(((T=s==null?void 0:s.data)==null?void 0:T.totalDocuments)||0),U(((_=s==null?void 0:s.data)==null?void 0:_.result)||[])}catch(l){console.error("Error fetching branch list",l),X("Failed to fetch branches")}finally{u(!1)}};a.useEffect(()=>{g()},[y,w,j,B,k,C,p]);const ue=t=>{n(t)},he=()=>{h(!1),d.success("Branch added successfully!"),f(c),g()},pe=t=>{G(t),n(1)},xe=async()=>{const t=Number(te),i={userId:"GK123"};try{u(!0);const o=await q.delete(`${R}/branch/delete/${t}`,{data:i,headers:{Authorization:`Bearer ${c}`}});(o==null?void 0:o.status)===201&&(N(!1),d.success("Branch deleted successfully!"),f(c),g())}catch(o){console.error("Error deleting branch",o),d.error("Failed to delete branch")}finally{u(!1)}},fe=()=>{ae(t=>t==="desc"?"":"desc"),n(1)},ge=t=>{Q(t),n(1)},be=t=>{se(t),n(1)},Se=t=>{re(t),n(1)},we=t=>{oe(t),n(1)},ye=()=>[{data:"id"},{data:"Branch Code"},{data:"name"},{data:"Role"},{data:"Actions"}],je=()=>E?E.map(t=>({id:t.id,data:[{data:t.id},{data:t.branchcode},{data:t.name},{data:t.role},{data:e.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:e.jsx(ke,{to:`/branch/${t.branchcode}`,children:e.jsx("button",{className:"p-1 text-blue-700 rounded hover:text-gray-500 dark:hover:text-gray-300",title:"View",children:e.jsx(qe,{size:18})})})}),className:"action-cell"}]})):[],ve=()=>{x(!1),d.success("Meeting and Document Created successfully!")},Ne=()=>{v(!1),d.success("Branch updated successfully!"),f(c),g()},Ce=()=>{const t=$.book_new(),i=$.json_to_sheet(H);$.book_append_sheet(t,i,"Branches"),Fe(t,"BranchList.xlsx")};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col min-h-screen",children:[e.jsxs("div",{className:"p-4 flex-grow",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-[var(--color-primary)] dark:text-[var(--color-primary)]",children:"Branch Management"}),r&&e.jsx("button",{onClick:()=>le(!M),className:"p-2 bg-gray-200 rounded-md",children:M?"Hide Filters":"Show Filters"})]}),e.jsx(Ve,{position:Le,reverseOrder:!1}),e.jsx("div",{className:`flex ${r?"flex-col":"items-end justify-end"} gap-4 mb-5`,children:e.jsxs("div",{className:`flex ${r?"flex-col":"flex-row"} gap-4`,children:[e.jsx(S,{options:me,selectedValue:p,onSelect:we,placeholder:"Items per page",className:"w-full md:w-[150px]"}),e.jsxs("button",{onClick:Ce,className:"flex items-center justify-center text-gray-400 bg-white focus:outline-non font-medium text-sm rounded-sm border border-dotted border-gray-400 hover:text-red-700/70 px-3 dark:bg-gray-800 dark:text-gray-300 py-2.5",children:[e.jsx(De,{className:"mr-1"}),!r&&"Export Excel"]}),e.jsxs("button",{onClick:()=>h(!0),className:"flex items-center justify-center text-white bg-[var(--color-primary)] hover-effect dark:bg-red-800 focus:outline-non font-medium text-sm rounded-sm px-5 py-2.5",children:[!r&&"New Branch"," +"]}),e.jsxs("button",{onClick:()=>x(!0),className:"flex items-center justify-center text-white bg-[var(--color-primary)] hover-effect dark:bg-red-800 focus:outline-non font-medium text-sm rounded-sm px-5 py-2.5",children:[!r&&"New Meeting"," ",e.jsx(Re,{className:"ml-2",size:15})]})]})}),e.jsx("div",{className:`${r&&!M?"hidden":"block"} mb-4`,children:e.jsxs("div",{className:`${r?"grid grid-cols-1 gap-3":"flex flex-wrap justify-between items-center gap-3"}`,children:[e.jsx(S,{options:de,selectedValue:j,onSelect:ge,placeholder:"Branch Status",className:"w-full md:w-[200px]"}),e.jsx(S,{options:ie,selectedValue:k,onSelect:Se,placeholder:"Branch Code",className:"w-full md:w-[200px]",isLoading:L}),e.jsx(S,{options:ce,selectedValue:B,onSelect:be,placeholder:"Manager",className:"w-full md:w-[200px]",isLoading:L}),e.jsxs("button",{onClick:fe,className:`${r?"w-full":"w-[200px]"} h-[40px] text-white bg-[var(--color-primary)] hover-effect px-2 py-1 rounded-sm`,children:["Sort ",C==="desc"?"↑":"↓"]}),e.jsx("div",{className:`${r?"w-full":"w-[200px] mt-3"}`,children:e.jsx(Ee,{value:w,onChange:pe,placeholder:"Search branches...",className:"w-full"})})]})}),m&&e.jsx("div",{className:"text-center py-4",children:"Loading..."}),D&&e.jsx("div",{className:"text-red-500 text-center py-4",children:D}),e.jsx("div",{className:"overflow-x-auto",children:e.jsx(Me,{thead:ye,tbody:je,responsive:!0,className:"min-w-full"})})]}),e.jsx("div",{className:"bottom-0 border-t border-gray-200 dark:border-gray-700 p-4",children:e.jsx($e,{total:J,currentPage:y,defaultPageSize:p,onChange:ue,paginationLabel:"branches",isScroll:!0})})]}),e.jsx(b,{isVisible:Y,className:"w-full md:w-[800px]",onClose:()=>h(!1),title:"Create New Branch",children:e.jsx(Oe,{onSuccess:he,onCancel:()=>h(!1)})}),e.jsx(b,{isVisible:Z,className:"w-full md:w-[800px]",onClose:()=>v(!1),title:"Edit Branch",children:e.jsx(ze,{branch:F,onSuccess:Ne,onCancel:()=>v(!1)})}),e.jsx(b,{isVisible:ne,className:"w-full md:w-[800px]",onClose:()=>x(!1),title:"Create Branch Meeting",children:e.jsx(_e,{branch:F,onSuccess:ve,onCancel:()=>x(!1)})}),e.jsx(b,{isVisible:ee,className:"w-full md:w-[600px]",onClose:()=>N(!1),title:"Delete Branch",children:e.jsxs("div",{className:"flex flex-col gap-6 dark:bg-gray-800 bg-white p-6 rounded-lg",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-100",children:"Confirm Deletion"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Are you sure you want to delete this branch? This action cannot be undone."})]}),e.jsxs("div",{className:"flex justify-center gap-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("button",{type:"button",className:"px-5 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 rounded-md transition-colors duration-200 font-medium text-sm",onClick:()=>N(!1),disabled:m,children:"Cancel"}),e.jsx("button",{type:"button",className:"px-5 py-2 bg-red-700 hover:bg-red-800 dark:bg-red-700 dark:hover:bg-red-800 text-white rounded-md transition-colors duration-200 font-medium text-sm shadow-sm",onClick:xe,disabled:m,children:m?e.jsx(Ae,{}):"Delete Branhch"})]})]})})]})},Rt=Be(Ge);export{Rt as default};
