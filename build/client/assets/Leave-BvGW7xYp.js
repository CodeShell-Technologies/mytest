import{w as Oe}from"./with-props-DF0D9zIo.js";import{r as t,j as e}from"./chunk-AYJ5UCUI-nSEPIBkT.js";import{D as $e}from"./DataTable-DtyPIAGZ.js";import{C as ze}from"./CustomPagination-CBTcVvJz.js";import"./SearchInput-CMdOUuSO.js";import{M as R}from"./Modal-BCIUwH-b.js";import{O as de,V as y}from"./index-DxoBGdjx.js";import{B as ne}from"./ButtonLoader-Z62NVHwI.js";import{u as _}from"./AuthStore-BnYeBJES.js";import{u as Ie}from"./useBranchStore-kvv3vD_e.js";import{u as ge}from"./use-click-outside-BhLpsQYS.js";import{D as Y}from"./DrapDown-CEm3nLdF.js";import{F as Me,u as te,w as Pe}from"./xlsx-DTxMWUdD.js";import{t as xe,a as J,B as K}from"./api-C04JdqFc.js";import{D as Ve}from"./index.es-Dy-HqQhS.js";/* empty css                         */import"./useEmployeeStore-BJ_SZO4g.js";import{C as ue}from"./clock-CzOQJT5p.js";import{U as Ue}from"./user-DKFoNGWn.js";import{C as re}from"./clipboard-list-C2ET-QCv.js";import{C as me}from"./calendar-C_LRGMui.js";import{F as he}from"./file-text-BNGbNc3I.js";import{E as fe,L as Re}from"./LeaveTypes-DGVd8zog.js";import{C as se}from"./circle-check-big-DhDS6nah.js";import{C as ye}from"./circle-x-Dr6D4A3M.js";import{F as He}from"./funnel-BXR2-FhQ.js";import{S as Ge}from"./square-pen-hueQTsQ_.js";import{T as Qe}from"./trash-2-AUNIB88j.js";import"./index-knF4tUPh.js";/* empty css            */import"./index-DDa5wjlm.js";import"./iconBase-CajCgYY2.js";import"./react-_sXfQCJm.js";import"./createLucideIcon-RccWoOaL.js";import"./clsx-B-dksMZM.js";import"./index-CyJ3O4p6.js";import"./moment-C5S46NFB.js";import"./EditLeaveForm-ZCAHbRg3.js";import"./hash-Cmnw3-GM.js";import"./eye-2Mk8PZw-.js";const Xe=({onSuccess:n,onCancel:L})=>{const[b,s]=t.useState(!1),[h,C]=t.useState(null),A=_(l=>l.accessToken),E=_(l=>l.staff_id),F=_(l=>l.branchcode),g=[{value:"casual",label:"Casual Leave"},{value:"sick",label:"Sick Leave"},{value:"event",label:"Event Leave"}],[p,v]=t.useState({staff_id:E,branchcode:F,leave_type:"casual",start_date:"",end_date:"",reason:""}),j=l=>{const{name:x,value:S}=l.target;v(r=>({...r,[x]:S}))},f=(l,x)=>{v(S=>({...S,[l]:x}))},I=async l=>{var x,S,r,o;if(l.preventDefault(),s(!0),new Date(p.end_date)<new Date(p.start_date)){C("End date cannot be before start date"),y.error("End date cannot be before start date"),s(!1);return}try{const i=await J.post(`${K}/users/leavereq/create`,p,{headers:{Authorization:`Bearer ${A}`}});i.status===201?(y.success("Leave request submitted successfully"),n()):(C(i.data.message||"Failed to create leave request"),y.error(i.data.message||"Failed to create leave request"))}catch(i){C(((S=(x=i.response)==null?void 0:x.data)==null?void 0:S.message)||"An error occurred"),y.error(((o=(r=i.response)==null?void 0:r.data)==null?void 0:o.message)||"Failed to create leave request")}finally{s(!1)}},k=l=>l?new Date(l).toISOString().split("T")[0]:"";return e.jsxs("div",{className:"flex flex-col gap-6 dark:bg-gray-800 bg-white p-6 rounded-lg",children:[e.jsx(de,{position:xe}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold border-b pb-2 text-gray-800 dark:text-gray-100 border-gray-200 dark:border-gray-700",children:[e.jsx(ue,{className:"inline mr-2"})," Leave Request Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(Ue,{className:"inline mr-1",size:14})," Staff ID"]}),e.jsx("input",{name:"staff_id",value:p.staff_id,readOnly:!0,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none cursor-not-allowed",type:"text"})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(re,{className:"inline mr-1",size:14})," Branch Code"]}),e.jsx("input",{name:"branchcode",value:p.branchcode,readOnly:!0,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none cursor-not-allowed",type:"text"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(re,{className:"inline mr-1",size:14})," Leave Type"]}),e.jsx("select",{name:"leave_type",value:p.leave_type,onChange:j,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",required:!0,children:g.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(me,{className:"inline mr-1",size:14})," Start Date"]}),e.jsx("input",{name:"start_date",type:"date",value:k(p.start_date),onChange:l=>f("start_date",l.target.value),className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",required:!0,min:new Date().toISOString().split("T")[0]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(me,{className:"inline mr-1",size:14})," End Date"]}),e.jsx("input",{name:"end_date",type:"date",value:k(p.end_date),onChange:l=>f("end_date",l.target.value),className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",required:!0,min:p.start_date||new Date().toISOString().split("T")[0]})]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2",children:[e.jsx(he,{className:"inline mr-1",size:14})," Reason"]}),e.jsx("textarea",{name:"reason",value:p.reason,onChange:j,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 focus:outline-none min-h-[100px]",placeholder:"Reason for leave...",required:!0})]})]}),h&&e.jsx("div",{className:"text-red-500 text-sm text-center py-2",children:h}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("button",{type:"button",className:"px-5 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 rounded-md transition-colors duration-200 font-medium text-sm",onClick:L,disabled:b,children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-5 py-2 bg-red-700 hover:bg-red-800 dark:bg-red-800 dark:hover:bg-red-900 text-white rounded-md transition-colors duration-200 font-medium text-sm shadow-sm",onClick:I,disabled:b,children:b?e.jsx(ne,{}):"Submit Leave Request"})]})]})},Ye=({leaveRequest:n,onSuccess:L,onCancel:b})=>{const[s,h]=t.useState({action:"approved",remarks:"",approved_dates:[],approval_type:"full"}),[C,A]=t.useState(!1),[E,F]=t.useState(null),[g,p]=t.useState([]),v=_(r=>r.accessToken),j=(r,o)=>{const i=[],m=new Date(r),N=new Date(o);for(;m<=N;)i.push(new Date(m)),m.setDate(m.getDate()+1);return i};t.useEffect(()=>{if(n){const r=j(n.start_date,n.end_date);p(r),h({action:n.status==="pending"?"approved":n.status,remarks:n.remarks||"",approved_dates:r.map(o=>o.toISOString().split("T")[0]),approval_type:"full"})}},[n]);const f=r=>{const{name:o,value:i}=r.target;h(m=>({...m,[o]:i,...o==="action"||o==="approval_type"?{approved_dates:[]}:{}}))},I=r=>{const o=r.toISOString().split("T")[0];h(i=>{const m=i.approved_dates.includes(o)?i.approved_dates.filter(N=>N!==o):[...i.approved_dates,o];return{...i,approved_dates:m,approval_type:m.length===g.length?"full":"partial"}})},k=()=>{const r=g.map(o=>o.toISOString().split("T")[0]);h(o=>({...o,approved_dates:r,approval_type:"full"}))},l=()=>{h(r=>({...r,approved_dates:[],approval_type:"partial"}))},x=async r=>{var o,i,m,N;if(r.preventDefault(),A(!0),s.action==="approved"&&s.approval_type==="partial"&&s.approved_dates.length===0){F("Please select at least one date for partial approval"),y.error("Please select at least one date for partial approval"),A(!1);return}try{const T=s.approval_type==="full"?{action:s.action,remarks:s.remarks}:{action:s.action,remarks:s.remarks,approved_dates:s.approved_dates},B=await J.put(`${K}/users/leaveaproved/edit/${n.req_id}`,T,{headers:{Authorization:`Bearer ${v}`}});B.status===200?(y.success(`Leave request ${s.action} successfully`),L()):(F(B.data.message||"Failed to update leave status"),y.error(B.data.message||"Failed to update leave status"))}catch(T){F(((i=(o=T.response)==null?void 0:o.data)==null?void 0:i.message)||"An error occurred"),y.error(((N=(m=T.response)==null?void 0:m.data)==null?void 0:N.message)||"Failed to update leave status")}finally{A(!1)}},S=r=>new Date(r).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"});return e.jsxs("div",{className:"flex flex-col gap-6 dark:bg-gray-800 bg-white p-6 rounded-lg",children:[e.jsx(de,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold border-b pb-2 text-gray-800 dark:text-gray-100 border-gray-200 dark:border-gray-700",children:[e.jsx(re,{className:"inline mr-2"})," Leave Request Approval"]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Staff ID"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mt-1",children:n==null?void 0:n.staff_id})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Leave Type"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 capitalize",children:n==null?void 0:n.leave_type})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Start Date"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mt-1",children:S(n==null?void 0:n.start_date)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"End Date"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mt-1",children:S(n==null?void 0:n.end_date)})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Reason"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mt-1",children:n==null?void 0:n.reason})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2",children:"Action"}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",name:"action",value:"approved",checked:s.action==="approved",onChange:f,className:"form-radio h-4 w-4 text-green-600 dark:text-green-500"}),e.jsxs("span",{className:"ml-2 text-sm font-medium text-gray-900 dark:text-gray-100",children:[e.jsx(se,{className:"inline mr-1",size:14})," Approve"]})]}),e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",name:"action",value:"rejected",checked:s.action==="rejected",onChange:f,className:"form-radio h-4 w-4 text-red-600 dark:text-red-500"}),e.jsxs("span",{className:"ml-2 text-sm font-medium text-gray-900 dark:text-gray-100",children:[e.jsx(ye,{className:"inline mr-1",size:14})," Reject"]})]})]})]}),s.action==="approved"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2",children:"Approval Type"}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",name:"approval_type",value:"full",checked:s.approval_type==="full",onChange:f,className:"form-radio h-4 w-4 text-blue-600 dark:text-blue-500"}),e.jsx("span",{className:"ml-2 text-sm font-medium text-gray-900 dark:text-gray-100",children:"Full Approval (All Days)"})]}),e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",name:"approval_type",value:"partial",checked:s.approval_type==="partial",onChange:f,className:"form-radio h-4 w-4 text-blue-600 dark:text-blue-500"}),e.jsx("span",{className:"ml-2 text-sm font-medium text-gray-900 dark:text-gray-100",children:"Partial Approval (Select Dates)"})]})]})]}),s.approval_type==="partial"&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Select Dates to Approve"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:k,className:"text-xs px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 rounded",children:"Select All"}),e.jsx("button",{type:"button",onClick:l,className:"text-xs px-2 py-1 bg-gray-100 dark:bg-gray-600 text-gray-800 dark:text-gray-200 rounded",children:"Clear"})]})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2 mt-2",children:g.map(r=>{const o=r.toISOString().split("T")[0],i=s.approved_dates.includes(o);return e.jsx("button",{type:"button",onClick:()=>I(r),className:`p-2 rounded text-center text-sm ${i?"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200":"bg-gray-100 dark:bg-gray-600 text-gray-800 dark:text-gray-200"}`,children:r.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})},o)})})]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2",children:[e.jsx(he,{className:"inline mr-1",size:14})," Remarks"]}),e.jsx("textarea",{name:"remarks",value:s.remarks,onChange:f,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 focus:outline-none min-h-[100px]",placeholder:s.action==="approved"?s.approval_type==="full"?"Approval remarks...":"Partial approval remarks...":"Rejection reason...",required:!0})]})]})]}),E&&e.jsx("div",{className:"text-red-500 text-sm text-center py-2",children:E}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("button",{type:"button",className:"px-5 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 rounded-md transition-colors duration-200 font-medium text-sm",onClick:b,disabled:C,children:"Cancel"}),e.jsx("button",{type:"submit",className:`px-5 py-2 text-white rounded-md transition-colors duration-200 font-medium text-sm shadow-sm ${s.action==="approved"?"bg-green-600 hover:bg-green-700 dark:bg-green-700 dark:hover:bg-green-800":"bg-red-600 hover:bg-red-700 dark:bg-red-700 dark:hover:bg-red-800"}`,onClick:x,disabled:C,children:C?e.jsx(ne,{}):s.action==="approved"?s.approval_type==="full"?"Approve All Days":`Approve ${s.approved_dates.length} Days`:"Reject Leave Request"})]})]})},Je=()=>{var pe;const n=ge({query:"(max-width: 768px)"}),[L,b]=t.useState(1),[s,h]=t.useState(!1),[C,A]=t.useState(0),[E,F]=t.useState(null),[g,p]=t.useState(""),[v,j]=t.useState(""),[f,I]=t.useState(10),[k,l]=t.useState([]),[x,S]=t.useState(null),[r,o]=t.useState(null),[i,m]=t.useState([]),[N,T]=t.useState(!1),[B,M]=t.useState(!1),[W,Z]=t.useState(null),[oe,P]=t.useState(!1),[le,V]=t.useState(!1),O=_(a=>a.accessToken),ie=_(a=>a.permissions),H=_(a=>a.staff_id),D=_(a=>a.branchcode),d=((pe=ie[0])==null?void 0:pe.role)||"employee",{branchCodeOptions:z,fetchBranches:U,isLoading:q}=Ie(),$=[{value:10,label:"10 per page"},{value:20,label:"20 per page"},{value:50,label:"50 per page"},{value:100,label:"100 per page"}],ee=[{value:"",label:"All Status"},{value:"pending",label:"Pending"},{value:"approved",label:"Approved"},{value:"rejected",label:"Rejected"}],[G,be]=t.useState(""),ve=()=>d==="superadmin"?z:d==="hr"?z.filter(a=>a.value===D):[];t.useEffect(()=>{(d==="superadmin"||d==="hr")&&U(O)},[O,d]),t.useEffect(()=>{d==="hr"&&p(D)},[d,D]);const je=()=>{M(!1),y.success("Leave create Request successfully!"),Q()};t.useEffect(()=>{d!=="hr"&&d!=="superadmin"&&j(H)},[d,H]),t.useEffect(()=>{(d==="superadmin"||d==="hr")&&(async()=>{if(d==="superadmin"&&!g||d==="hr"&&!D){m([]);return}h(!0);try{const w=`${K}/users/dropdown?branchcode=${d==="hr"?D:g}`,u=await J.get(w,{headers:{Authorization:`Bearer ${O}`}});if(u.data&&u.data.data){const ae=u.data.data.map(X=>({value:X.staff_id,label:`${X.firstname} ${X.lastname} (${X.staff_id})`}));m(ae)}}catch(c){console.error("Error fetching staff list",c),y.error("Failed to fetch staff")}finally{h(!1)}})()},[g,O,d,D]);const Q=async()=>{h(!0);try{let a=`${K}/users/leavereq/read`;const c=new URLSearchParams;d==="superadmin"?(g&&c.append("branchcode",g),v&&c.append("staff_id",v)):d==="hr"?(c.append("branchcode",D),v&&c.append("staff_id",v)):c.append("staff_id",H),G&&c.append("status",G),x&&c.append("start_date",ce(x)),r&&c.append("end_date",ce(r)),c.append("page",L),c.append("limit",f),a+=`?${c.toString()}`;const w=await J.get(a,{headers:{Authorization:`Bearer ${O}`}});w.data&&(l(w.data.data||[]),A(w.data.totalDocuments||0))}catch(a){console.error("Error fetching leave requests",a),y.error("Failed to fetch leave requests"),F("Failed to fetch data")}finally{h(!1)}},ce=a=>{if(!a)return"";const c=new Date(a),w=c.getFullYear(),u=(c.getMonth()+1).toString().padStart(2,"0"),ae=c.getDate().toString().padStart(2,"0");return`${w}-${u}-${ae}`},ke=a=>{b(a)},Se=a=>{p(a),j(""),b(1)},Ne=a=>{j(a),b(1)},we=a=>{I(a),b(1)},Ce=a=>{const[c,w]=a;S(c),o(w)},De=a=>{be(a),b(1)},_e=()=>{P(!1),y.success("Leave Data updated successfully!"),U(O),Q()},Le=()=>{V(!1),y.success("Leave Request Approved successfully!"),U(O),Q()},Ae=()=>{if(!k||k.length===0){y.error("No data to export");return}const a=k.map(u=>({"Staff ID":u.staff_id,"Branch Code":u.branchcode,"Leave Type":u.leave_type,"Start Date":u.start_date,"End Date":u.end_date,Reason:u.reason,Status:u.status,"Applied On":u.requested_on,"Approved/Rejected On":u.updated_on})),c=te.book_new(),w=te.json_to_sheet(a);te.book_append_sheet(c,w,"LeaveRequests"),Pe(c,"LeaveRequests.xlsx")};t.useEffect(()=>{Q()},[L,f,g,v,G,x,r,d,D]);const Ee=a=>{Z(a),P(!0)},Fe=a=>{Z(a),V(!0)},Te=()=>[{data:"Staff ID"},{data:"Branch Code"},{data:"Leave Type"},{data:"Start Date"},{data:"End Date"},{data:"Reason"},{data:"Status"},{data:"Applied On"},{data:"Approved By"},{data:"Approved Date"},{data:"Action"}],Be=()=>k?k.map(a=>({id:a._id,data:[{data:a.staff_id},{data:a.branchcode},{data:a.leave_type},{data:new Date(a.start_date).toLocaleDateString()},{data:new Date(a.end_date).toLocaleDateString()},{data:a.reason},{data:e.jsxs("div",{className:`px-3 py-1 rounded-full text-sm inline-flex items-center ${a.status==="approved"?"bg-green-100 text-green-800":a.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:[a.status==="approved"?e.jsx(se,{className:"w-3 h-3 mr-1"}):a.status==="rejected"?e.jsx(ye,{className:"w-3 h-3 mr-1"}):e.jsx(ue,{className:"w-3 h-3 mr-1"}),a.status.charAt(0).toUpperCase()+a.status.slice(1)]})},{data:new Date(a.requested_on).toLocaleDateString()},{data:a.approved_by_name},{data:new Date(a.approval_date).toLocaleDateString()},{data:e.jsxs("div",{className:"flex flex-nowrap justify-center gap-2",children:[d!=="hr"&&d!=="superadmin"&&e.jsx("button",{className:"p-1 text-[var(--color-primary)] rounded hover:text-gray-500 dark:hover:text-gray-300",onClick:()=>Ee(a),title:"Edit",children:e.jsx(Ge,{size:18})}),d!=="hr"&&d!=="superadmin"&&e.jsx("button",{className:"p-1 text-red-600 rounded hover:text-gray-500 dark:hover:text-gray-300",onClick:()=>handleDeleteBranch(branch.id),title:"Delete",children:e.jsx(Qe,{size:18})}),(d==="hr"||d==="superadmin")&&e.jsx("button",{className:"p-1 text-amber-600 rounded hover:text-gray-500 dark:hover:text-gray-300",onClick:()=>Fe(a),title:"Approve",children:e.jsx(se,{size:18})})]}),className:"action-cell"}]})):[];return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-col min-h-screen",children:e.jsxs("div",{className:"p-4 flex-grow",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-[var(--color-primary)] dark:text-[var(--color-primary)]",children:"Leave Requests"}),e.jsxs("button",{onClick:()=>M(!0),className:"flex items-center justify-center text-white bg-[var(--color-primary)] hover-effect dark:bg-red-800 focus:outline-non font-medium text-sm rounded-sm px-5 py-2.5",children:[!n&&"New Leave Req"," +"]}),n&&e.jsxs("button",{onClick:()=>T(!N),className:"p-2 bg-gray-200 rounded-md",children:[e.jsx(He,{size:18,className:"mr-1"}),N?"Hide Filters":"Show Filters"]})]}),e.jsx(de,{position:xe,reverseOrder:!1}),e.jsx("div",{className:`${n&&!N?"hidden":"block"} mb-4`,children:e.jsxs("div",{className:`grid grid-cols-1 ${d!=="superadmin"&&d!=="hr"?"md:grid-cols-2 lg:grid-cols-2 gap-3":"md:grid-cols-4 lg:grid-cols-4 gap-20"}`,children:[d==="superadmin"&&e.jsx(Y,{options:ve(),selectedValue:g,onSelect:Se,placeholder:"Select Branch",className:"w-[245px]",isLoading:q}),(d==="superadmin"||d==="hr")&&e.jsx(Y,{options:i,selectedValue:v,onSelect:Ne,placeholder:"Select Staff",className:"w-[245px]",disabled:d==="hr"?!1:!g,isLoading:s}),e.jsx(Y,{options:ee,selectedValue:G,onSelect:De,placeholder:"Select Status",className:"w-[245px]"}),e.jsx("div",{className:"w-[245px]",children:e.jsx(Ve,{selectsRange:!0,startDate:x,endDate:r,onChange:Ce,placeholderText:"Select date range",className:"w-full p-2 border rounded h-[40px]",isClearable:!0})})]})}),e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx(Y,{options:$,selectedValue:f,onSelect:we,placeholder:"Items per page",className:"w-[150px]"}),e.jsxs("button",{onClick:Ae,className:"flex items-center justify-center text-gray-400 bg-white focus:outline-non font-medium text-sm rounded-sm border border-dotted border-gray-400 hover:text-red-700/70 px-3 dark:bg-gray-800 dark:text-gray-300 py-2",disabled:k.length===0,children:[e.jsx(Me,{className:"mr-1"}),!n&&"Export Excel"]})]}),s&&e.jsx("div",{className:"text-center py-4",children:"Loading..."}),E&&e.jsx("div",{className:"text-red-500 text-center py-4",children:E}),e.jsx("div",{className:"overflow-x-auto",children:e.jsx($e,{thead:Te,tbody:Be,responsive:!0,className:"min-w-full"})}),e.jsx("div",{className:"bottom-0 border-t border-gray-200 dark:border-gray-700 p-4",children:e.jsx(ze,{total:C,currentPage:L,defaultPageSize:f,onChange:ke,paginationLabel:"leave requests",isScroll:!0})})]})}),e.jsx(R,{isVisible:B,className:"w-full md:w-[800px]",onClose:()=>M(!1),title:"Create New Branch",children:e.jsx(Xe,{onSuccess:je,onCancel:()=>M(!1)})}),e.jsx(R,{isVisible:oe,className:"w-full md:w-[800px]",onClose:()=>P(!1),title:"Edit Branch",children:e.jsx(fe,{leaveRequest:W,onSuccess:_e,onCancel:()=>P(!1)})}),e.jsx(R,{isVisible:le,className:"w-full md:w-[800px]",onClose:()=>V(!1),title:"Approved Leave Request",children:e.jsx(Ye,{leaveRequest:W,onSuccess:Le,onCancel:()=>V(!1)})})]})},Ke=()=>{ge({query:"(max-width: 768px)"});const[n,L]=t.useState(""),[b,s]=t.useState(1),[h,C]=t.useState(""),[A,E]=t.useState([]),[F,g]=t.useState(""),[p,v]=t.useState([]),[j,f]=t.useState(!1),[I,k]=t.useState(0),[l,x]=t.useState(null),[S,r]=t.useState(!1),[o,i]=t.useState(!1),[m,N]=t.useState(),[T,B]=t.useState(!1),[M,W]=t.useState(""),[Z,oe]=t.useState(""),[P,le]=t.useState(""),[V,O]=t.useState(""),[ie,H]=t.useState(8),[D,d]=t.useState(!1);_($=>$.accessToken);const[z,U]=t.useState("leavereq"),q=[{id:"leavereq",label:"Leave Request"},{id:"leavetype",label:"Leave Types"}];return e.jsxs("div",{className:"flex flex-col min-h-screen",children:[e.jsx("div",{className:"  dark:border-gray-700  ",children:e.jsx("nav",{className:"flex justify-evenly -mb-px",children:q.map(($,ee)=>e.jsxs(e.Fragment,{children:[ee>0&&e.jsx("span",{className:"bg-gray-300 dark:bg-red-700 w-[50px] h-[2px] mt-5 items-center"}),e.jsx("button",{onClick:()=>U($.id),className:` font-medium text-sm  ${z===$.id?" text-gray-200 dark:bg-gray-800 dark:text-red-800 hover:border-gray-300 bg-red-700 w-[120px] h-[40px] rounded-sm ":"border-transparent text-gray-700 hover:text-red-700 dark:bg-gray-600 dark:text-gray-100 hover:border-gray-300 bg-gray-200 w-[120px] h-[40px] rounded-sm "}`,children:$.label},$.id)]}))})}),e.jsxs("div",{className:"p-4 flex-grow",children:[z==="leavereq"&&e.jsx(Je,{}),z==="leavetype"&&e.jsx("div",{children:e.jsx(Re,{})}),z==="report"&&e.jsx("div",{children:"termination Content Goes Here"})]}),e.jsx(R,{isVisible:o,className:"w-full md:w-[800px]",onClose:()=>i(!1),title:"Update Leave Request",children:e.jsx(fe,{onCancel:()=>i(!1)})}),e.jsx(R,{isVisible:T,className:"w-full md:w-[600px]",onClose:()=>B(!1),title:"Delete Branch",children:e.jsxs("div",{className:"flex flex-col gap-6 justify-center items-center",children:[e.jsx("p",{className:"text-gray-500 text-lg font-bold text-center",children:"Are you sure you want to delete this Leave Details?"}),e.jsxs("div",{className:"flex gap-4 flex-wrap justify-center",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-[var(--color-secondary)] hover:bg-[var(--color-hover-secondary)] text-gray-800 hover-effect dark:text-gray-700 rounded dark:hover:bg-gray-500 transition",disabled:j,onClick:()=>B(!1),children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-[var(--color-primary)] text-white rounded hover:bg-[var(--color-hover)] hover-effect transition",disabled:j,children:j?e.jsx(ne,{}):"Confirm"})]})]})})]})},za=Oe(Ke);export{za as default};
