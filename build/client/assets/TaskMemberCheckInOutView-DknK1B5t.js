import{w as me}from"./with-props-DF0D9zIo.js";import{r as c,j as e,c as ge,u as xe}from"./chunk-AYJ5UCUI-nSEPIBkT.js";import{a as j,B as k,t as ne}from"./api-C04JdqFc.js";import{u as O}from"./AuthStore-BnYeBJES.js";import{V as b,O as oe}from"./index-DxoBGdjx.js";import{D as ue}from"./DataTable-DtyPIAGZ.js";import{C as he}from"./CustomPagination-CBTcVvJz.js";import{M as pe}from"./Modal-BCIUwH-b.js";import{B as ye}from"./ButtonLoader-Z62NVHwI.js";import{u as fe}from"./useBranchStore-kvv3vD_e.js";import{V as be,F as te,L as je,M as ke,C as ve}from"./video-BzePKQuD.js";import{F as ae}from"./file-text-BNGbNc3I.js";import{C as X}from"./clipboard-list-C2ET-QCv.js";import{F as Ne}from"./file-QxKA-9Fo.js";import{C as we}from"./calendar-C_LRGMui.js";import{C as _e}from"./clock-CzOQJT5p.js";import{U as H}from"./users-CXAhoVGa.js";import{X as K}from"./x-BfrbTbzo.js";import{C as re}from"./chevron-up-DjUqBI0v.js";import{C as se}from"./chevron-down-DOBgonSl.js";import{P as Ce}from"./plus-HifIQSWH.js";import{D as Te}from"./dot-BRbGo9NO.js";import{L as Se}from"./log-out-DAuSHV9-.js";import{M as De}from"./message-square-text-D3my64cM.js";import{U as ze}from"./user-DKFoNGWn.js";import{C as Fe}from"./calendar-check-2-BfAjpHZ6.js";import{C as Me}from"./calendar-clock-hGpbKQUd.js";import{A as Ie}from"./alarm-clock-check-ZK0mJr1H.js";import{c as $e}from"./createLucideIcon-RccWoOaL.js";import{C as Be}from"./circle-check-big-DhDS6nah.js";import"./react-_sXfQCJm.js";import"./index-knF4tUPh.js";/* empty css            */import"./index-DDa5wjlm.js";import"./iconBase-CajCgYY2.js";/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=[["path",{d:"M10 2h4",key:"n1abiw"}],["path",{d:"M4.6 11a8 8 0 0 0 1.7 8.7 8 8 0 0 0 8.7 1.7",key:"10he05"}],["path",{d:"M7.4 7.4a8 8 0 0 1 10.3 1 8 8 0 0 1 .9 10.2",key:"15f7sh"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M12 12v-2",key:"fwoke6"}]],Pe=$e("timer-off",Ee),Ae=({memberData:d,onSuccess:R,onCancel:$})=>{console.log("projectcodeee",d);const[T,B]=c.useState(!1),[S,D]=c.useState(null),[h,w]=c.useState([]),[y,f]=c.useState([]),[E,P]=c.useState([]),[U,A]=c.useState([]),[L,_]=c.useState([]),[z,Q]=c.useState(!1),[F,C]=c.useState(!1),x=O(t=>t.accessToken);O(t=>t.permissions)[0].role,fe(t=>t.branchCodeOptions),O(t=>t.branchcode);const[g,v]=c.useState([{type:"",branchcode:"",teamId:"",staffType:"staff"}]),[s,N]=c.useState({branchcode:d.branchcode,task_participants:d.participants_id,title:"",notes:"",comm_type:"meeting",status:"active",doc_status:"none",meet_link:"",start_date_time:"2025-02-01T00:00:00Z,",end_date_time:"2025-02-01T23:59:59Z",category:"branch",field:"custom",doc:[],custom:[],communication_participants:[]});c.useEffect(()=>{(async()=>{try{const a=await j.get(`${k}/branch/dropdown`,{headers:{Authorization:`Bearer ${x}`}});P(a.data.result)}catch(a){console.error("Error fetching initial data:",a),b.error("Failed to load initial data")}})()},[x]),c.useEffect(()=>{const t=[...new Set(g.filter(r=>r.type==="team"&&r.branchcode).map(r=>r.branchcode))],a=async()=>{try{const r=t.map(async m=>(await j.get(`${k}/teams/read?branchcode=${m}`,{headers:{Authorization:`Bearer ${x}`}})).data.data),i=await Promise.all(r);A(i.flat())}catch(r){console.error("Error fetching teams:",r),b.error("Failed to load teams")}};t.length>0&&a()},[g,x]),c.useEffect(()=>{s.category==="custom"?q():s.category==="branch"&&s.branchcode?M():s.category==="team"&&V()},[s.category,s.branchcode,g]);const M=async()=>{try{const t=await j.post(`${k}/users/filter`,{branch:[s.branchcode],team:[],type:["staff","client"]},{headers:{Authorization:`Bearer ${x}`}});_([...t.data.staff,...t.data.client])}catch(t){console.error("Error fetching branch participants:",t),b.error("Failed to fetch participants")}},V=async()=>{try{const t=await j.post(`${k}/users/filter`,{branch:[s.branchcode],team:[],type:["staff","client"]},{headers:{Authorization:`Bearer ${x}`}});_([...t.data.staff,...t.data.client])}catch(t){console.error("Error fetching branch participants:",t),b.error("Failed to fetch participants")}},q=async()=>{try{const t=g.filter(o=>o.type==="branch"&&o.branchcode).map(o=>o.branchcode),a=g.filter(o=>o.type==="team"&&o.teamId&&o.branchcode).map(o=>{const ee=o.teamId.split("/"),le=ee[ee.length-1];return`${o.branchcode}/TEAM/${le}`}),r=g.filter(o=>o.type==="team"&&o.branchcode).map(o=>o.branchcode),i=[...new Set([...t,...r])],m=[];g.forEach(o=>{(o.type==="branch"||o.type==="team")&&(o.staffType==="staff"&&m.push("staff"),o.staffType==="client"&&m.push("client"),o.staffType==="both"&&(m.push("staff"),m.push("client")))});const l=[...new Set(m)];if(console.log("Sending filter request with:",{branch:i,team:a,type:l.length>0?l:["staff","client"]}),i.length>0||a.length>0){const o=await j.post(`${k}/users/filter`,{branch:i,team:a,type:l.length>0?l:["staff","client"]},{headers:{Authorization:`Bearer ${x}`}});_([...o.data.staff,...o.data.client])}else _([])}catch(t){console.error("Error fetching custom participants:",t),b.error("Failed to fetch participants")}},p=t=>{const{name:a,value:r}=t.target;N(i=>({...i,[a]:r})),a==="category"&&(f([]),v([{type:"",branchcode:"",teamId:"",staffType:"staff"}]))},Z=t=>{const a=Array.from(t.target.files);if(a.length===0)return;const r=a.map(i=>({file:i,name:i.name,type:i.type.split("/")[1]||"file"}));N(i=>({...i,doc:[...i.doc,...r]}))},G=t=>{N(a=>{const r=[...a.doc];return r.splice(t,1),{...a,doc:r}})},n=t=>{h.some(a=>a.person_id===t.person_id)||w([...h,{person_id:t.person_id,role:t.role,isdocvisible:s.comm_type==="doc"}])},u=t=>{w(h.filter(a=>a.person_id!==t))},J=t=>{w(h.map(a=>a.person_id===t?{...a,isdocvisible:!a.isdocvisible}:a))},Y=(t,a)=>{if(t==="team"){const r=g.find(i=>i.type==="team"&&i.teamId===a);if(r&&r.branchcode){const i=a.split("/"),m=i[i.length-1],l=`${r.branchcode}/TEAM/${m}`;y.some(o=>o.target_id===l&&o.type===t)||f([...y,{target_id:l,type:t}]);return}}y.some(r=>r.target_id===a&&r.type===t)||f([...y,{target_id:a,type:t}])},I=(t,a,r)=>{const i=[...g];i[t][a]=r,a==="type"?(i[t].branchcode="",i[t].teamId=""):a==="branchcode"&&i[t].type==="team"&&(i[t].teamId=""),v(i)},ie=()=>{v([...g,{type:"",branchcode:"",teamId:"",staffType:"staff"}])},de=t=>{var a,r,i,m;if(g.length>1){const l=[...g];l.splice(t,1),v(l),((a=l[t])==null?void 0:a.type)==="branch"&&((r=l[t])!=null&&r.branchcode)?f(y.filter(o=>!(o.type==="branch"&&o.target_id===l[t].branchcode))):((i=l[t])==null?void 0:i.type)==="team"&&((m=l[t])!=null&&m.teamId)&&f(y.filter(o=>!(o.type==="team"&&o.target_id===l[t].teamId)))}},ce=async t=>{var a,r;t.preventDefault(),B(!0);try{const i={branchcode:taskData.branchcode,task_id:taskData.id,title:s.title,notes:s.notes,comm_type:s.comm_type,status:s.status,meet_link:s.meet_link,start_date_time:s.start_date_time,end_date_time:s.end_date_time,doc_status:s.doc_status,category:s.category,field:s.field,custom:y,communication_participants:h},m=new FormData;m.append("data",JSON.stringify([i])),s.doc.forEach(o=>{m.append("URL",o.file)}),console.log("formataaaanew form",m);const l=await j.post(`${k}/doc_meet/create`,m,{headers:{Authorization:`Bearer ${x}`,"Content-Type":"multipart/form-data"}});l.status===201?(R(),N({branchcode:project.branchcode,client_code:project.client_code,project_code:project.project_code,title:"",notes:"",comm_type:"meeting",status:"active",doc_status:"none",meet_link:"",start_date_time:"2025-02-01T00:00:00Z,",end_date_time:"2025-02-01T23:59:59Z",category:"branch",field:"custom",doc:[],custom:[],communication_participants:[]})):D(l.data.message||"Failed to create communication")}catch(i){D(((r=(a=i.response)==null?void 0:a.data)==null?void 0:r.message)||"An error occurred"),b.error(`Error creating ${s.comm_type==="meeting"?"meeting":"document"}`)}finally{B(!1)}};return e.jsxs("div",{className:"flex flex-col gap-6 dark:bg-gray-800 bg-white p-6 rounded-lg",children:[e.jsx(oe,{position:ne}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold border-b pb-2 text-gray-800 dark:text-gray-100 border-gray-200 dark:border-gray-700",children:[s.comm_type==="meeting"?e.jsx(be,{className:"inline mr-2"}):e.jsx(te,{className:"inline mr-2"}),s.comm_type==="meeting"?"Meeting Information":"Document Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(ae,{className:"inline mr-1",size:14})," Title",e.jsx("span",{className:"text-red-700 text-lg m-2",children:"*"})]}),e.jsx("input",{name:"title",value:s.title,onChange:p,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",type:"text",placeholder:"Title",required:!0})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(X,{className:"inline mr-1",size:14})," Type",e.jsx("span",{className:"text-red-700 text-lg m-2",children:"*"})]}),e.jsxs("select",{name:"comm_type",value:s.comm_type,onChange:p,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",required:!0,children:[e.jsx("option",{value:"meeting",children:"Meeting"}),e.jsx("option",{value:"doc",children:"Document"}),e.jsx("option",{value:"followup",children:"Follow-up"})]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(X,{className:"inline mr-1",size:14})," Status"]}),e.jsxs("select",{name:"status",value:s.status,onChange:p,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",required:!0,children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"declined",children:"Declined"})]})]}),s.comm_type==="doc"&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(Ne,{className:"inline mr-1",size:14})," Document Status"]}),e.jsxs("select",{name:"doc_status",value:s.doc_status,onChange:p,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",children:[e.jsx("option",{value:"none",children:"None"}),e.jsx("option",{value:"archived",children:"Archived"}),e.jsx("option",{value:"verified-closed",children:"Verified & Closed"}),e.jsx("option",{value:"rework",children:"Rework"})]})]}),s.comm_type==="meeting"&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(je,{className:"inline mr-1",size:14})," Meeting Link",e.jsx("span",{className:"text-red-700 text-lg m-2",children:"*"})]}),e.jsx("input",{name:"meet_link",value:s.meet_link,onChange:p,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",type:"url",placeholder:"https://meet.google.com/example",required:!0})]}),s.comm_type==="meeting"&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(we,{className:"inline mr-1",size:14})," Start Date/Time",e.jsx("span",{className:"text-red-700 text-lg m-2",children:"*"})]}),e.jsx("input",{name:"start_date_time",value:s.start_date_time,onChange:p,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",type:"datetime-local",required:!0})]}),s.comm_type==="meeting"&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(_e,{className:"inline mr-1",size:14})," End Date/Time",e.jsx("span",{className:"text-red-700 text-lg m-2",children:"*"})]}),e.jsx("input",{name:"end_date_time",value:s.end_date_time,onChange:p,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",type:"datetime-local",required:!0})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(H,{className:"inline mr-1",size:14})," Category",e.jsx("span",{className:"text-red-700 text-lg m-2",children:"*"})]}),e.jsxs("select",{name:"category",value:s.category,onChange:p,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",required:!0,children:[e.jsx("option",{value:"branch",children:"Branch"}),e.jsx("option",{value:"team",children:"Team"}),e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"custom",children:"Custom"})]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(X,{className:"inline mr-1",size:14})," Field"]}),e.jsxs("select",{name:"field",value:s.field,onChange:p,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",children:[e.jsx("option",{value:"project",children:"Project"}),e.jsx("option",{value:"task",children:"Task"}),e.jsx("option",{value:"lead",children:"Lead"}),e.jsx("option",{value:"custom",children:"Custom"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2",children:[e.jsx(ae,{className:"inline mr-1",size:14})," Notes"]}),e.jsx("textarea",{name:"notes",value:s.notes,onChange:p,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 focus:outline-none min-h-[100px]",placeholder:"Notes...",required:!0})]}),s.comm_type==="doc"&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2",children:[e.jsx(te,{className:"inline mr-1",size:14})," Documents"]}),e.jsx("input",{type:"file",id:"file-upload",multiple:!0,onChange:Z,className:"w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-[var(--color-primary)] file:text-white hover:file:bg-[var(--color-hover)]"}),s.doc.length>0&&e.jsx("div",{className:"mt-4 space-y-2",children:s.doc.map((t,a)=>e.jsxs("div",{className:"flex justify-between items-center p-2 bg-gray-100 dark:bg-gray-700 rounded",children:[e.jsx("span",{className:"text-sm",children:t.name}),e.jsx("button",{type:"button",onClick:()=>G(a),className:"text-red-500 hover:text-red-700",children:e.jsx(K,{size:16})})]},a))})]}),s.category==="custom"&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center cursor-pointer",onClick:()=>C(!F),children:[e.jsxs("h4",{className:"text-sm font-semibold",children:[e.jsx(H,{className:"inline mr-2",size:16}),"Custom Filters (",y.length,")"]}),F?e.jsx(re,{size:16}):e.jsx(se,{size:16})]}),F&&e.jsxs("div",{className:"mt-4 space-y-4",children:[g.map((t,a)=>e.jsxs("div",{className:"space-y-4 p-4 bg-gray-100 dark:bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h5",{className:"text-sm font-medium",children:["Filter ",a+1]}),g.length>1&&e.jsx("button",{type:"button",onClick:()=>de(a),className:"text-red-500 hover:text-red-700 p-1",children:e.jsx(ke,{size:16})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Filter Type"}),e.jsxs("select",{value:t.type,onChange:r=>I(a,"type",r.target.value),className:"w-full bg-white dark:bg-gray-800 text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 p-2 rounded border border-gray-300 dark:border-gray-600 focus:outline-none",children:[e.jsx("option",{value:"",children:"Select filter type"}),e.jsx("option",{value:"branch",children:"Branch"}),e.jsx("option",{value:"team",children:"Team"})]})]}),(t.type==="branch"||t.type==="team")&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Branch"}),e.jsxs("select",{value:t.branchcode,onChange:r=>{I(a,"branchcode",r.target.value),I(a,"teamId","")},className:"w-full bg-white dark:bg-gray-800 text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 p-2 rounded border border-gray-300 dark:border-gray-600 focus:outline-none",children:[e.jsx("option",{value:"",children:"Select branch"}),E.map(r=>e.jsxs("option",{value:r.branchcode,children:[r.branchcode," - ",r.name]},r.branchcode))]})]}),t.type==="team"&&t.branchcode&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Team"}),e.jsxs("select",{value:t.teamId,onChange:r=>{I(a,"teamId",r.target.value),r.target.value&&Y("team",r.target.value)},className:"w-full bg-white dark:bg-gray-800 text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 p-2 rounded border border-gray-300 dark:border-gray-600 focus:outline-none",children:[e.jsx("option",{value:"",children:"Select team"}),U.filter(r=>r.branchcode===t.branchcode).map(r=>e.jsx("option",{value:r.team_id,children:r.team_name},r.team_id))]})]}),(t.type==="branch"||t.type==="team")&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Staff Type"}),e.jsxs("select",{value:t.staffType,onChange:r=>I(a,"staffType",r.target.value),className:"w-full bg-white dark:bg-gray-800 text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 p-2 rounded border border-gray-300 dark:border-gray-600 focus:outline-none",children:[e.jsx("option",{value:"staff",children:"Staff"}),e.jsx("option",{value:"client",children:"Client"}),e.jsx("option",{value:"both",children:"Both"})]})]})]}),t.type==="branch"&&t.branchcode&&e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"button",onClick:()=>Y("branch",t.branchcode),className:"text-xs bg-red-700 hover:bg-red-700 text-white px-2 py-1 rounded",children:"Add Branch Filter"})})]},a)),e.jsxs("button",{type:"button",onClick:ie,className:"flex items-center text-sm text-blue-500 hover:text-blue-700",children:[e.jsx(Ce,{size:16,className:"mr-1"}),"Add Another Filter"]})]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center cursor-pointer",onClick:()=>Q(!z),children:[e.jsxs("h4",{className:"text-sm font-semibold",children:[e.jsx(H,{className:"inline mr-2",size:16}),"Participants (",h.length,")"]}),z?e.jsx(re,{size:16}):e.jsx(se,{size:16})]}),z&&e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-2",children:s.category==="custom"?"Select participants from filtered results":`Select participants from ${s.category}`}),L.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:L.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-100 dark:bg-gray-700 rounded",children:[e.jsxs("span",{children:[t.person_id," (",t.role,")"]}),h.some(a=>a.person_id===t.person_id)?e.jsx("button",{type:"button",onClick:()=>u(t.person_id),className:"text-red-500 hover:text-red-700",children:e.jsx(K,{size:16})}):e.jsx("button",{type:"button",onClick:()=>n(t),className:"text-green-500 hover:text-green-700",children:e.jsx(ve,{size:16})})]},t.person_id))}):e.jsx("p",{className:"text-sm text-gray-500",children:"No participants available based on current filters"})]}),h.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Selected Participants"}),e.jsx("div",{className:"space-y-2",children:h.map(t=>e.jsxs("div",{className:"flex justify-between items-center p-2 bg-gray-100 dark:bg-gray-700 rounded",children:[e.jsxs("span",{children:[t.person_id," (",t.role,")"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[s.comm_type==="doc"&&e.jsxs("label",{className:"flex items-center space-x-1",children:[e.jsx("input",{type:"checkbox",checked:t.isdocvisible,onChange:()=>J(t.person_id),className:"rounded"}),e.jsx("span",{className:"text-xs",children:"View Doc"})]}),e.jsx("button",{type:"button",onClick:()=>u(t.person_id),className:"text-red-500 hover:text-red-700",children:e.jsx(K,{size:16})})]})]},t.person_id))})]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("button",{type:"button",className:"px-5 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 rounded-md transition-colors duration-200 font-medium text-sm",onClick:$,disabled:T,children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-5 py-2 bg-red-700 hover:bg-red-800 dark:bg-red-700 dark:hover:bg-red-800 text-white rounded-md transition-colors duration-200 font-medium text-sm shadow-sm",onClick:ce,disabled:T,children:T?e.jsx(ye,{}):s.comm_type==="meeting"?"Create Meeting":"Upload Document"})]})]})},Le=()=>{const[d,R]=c.useState(null),[$,T]=c.useState([]),[B,S]=c.useState(!0),[D,h]=c.useState(null),[w,y]=c.useState(!1),[f,E]=c.useState(!1),[P,U]=c.useState(""),[A,L]=c.useState("member"),[_,z]=c.useState(1),[Q,F]=c.useState(0),C=O(n=>n.accessToken),{id:x}=ge(),W=xe(),[g,v]=c.useState(!1),s=async()=>{var n;try{S(!0);const u=await j.get(`${k}/project/task/members/read?participants_id=${x}`,{headers:{Authorization:`Bearer ${C}`}});R(u.data.data[0]),F((n=u==null?void 0:u.data)==null?void 0:n.totalDocuments),N()}catch(u){h(u.message),S(!1)}},N=async()=>{try{const n=await j.get(`${k}/project/task/checkinout/read?participants_id=${x}`,{headers:{Authorization:`Bearer ${C}`}});T(n.data.data),n.data.data.length>0&&!n.data.data[0].check_out&&y(!0),S(!1)}catch(n){h(n.message),S(!1)}};c.useEffect(()=>{s()},[x]);const M=async n=>{try{await j.post(`${k}/project/task/checkinout/create`,{data:{participants_id:parseInt(x)}},{headers:{Authorization:`Bearer ${C}`}}),b.success(n?"Checked in successfully!":"Checked out successfully!"),N(),y(n)}catch(u){b.error(`Failed to ${n?"check in":"check out"}`),console.error(u)}},V=async()=>{try{const n={participants_id:parseInt(x),status:"archived"};f&&(n.delay_by=A,n.delay_reason=P),await j.post(`${k}/project/task/checkinout/create`,{data:n},{headers:{Authorization:`Bearer ${C}`}}),w&&await M(!1),b.success("Task marked as completed!"),s(),E(!1)}catch(n){b.error("Failed to complete task"),console.error(n)}},q=n=>{const u=Math.floor(n/60),J=n%60;return`${u.toString().padStart(2,"0")}:${J.toString().padStart(2,"0")}`},p=()=>[{data:"Date"},{data:"Check In"},{data:"Check Out"},{data:"Duration"}],Z=()=>$.map(n=>({id:n.id,data:[{data:new Date(n.check_in).toLocaleDateString()},{data:new Date(n.check_in).toLocaleTimeString()},{data:n.check_out?new Date(n.check_out).toLocaleTimeString():"-"},{data:q(n.duration)}]})),G=()=>{v(!1),b.success("Meeting and Document Created successfully!")};return B?e.jsx("div",{className:"p-4",children:"Loading..."}):D?e.jsxs("div",{className:"p-4 text-red-500",children:["Error: ",D]}):d?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(oe,{position:ne}),e.jsx("div",{className:"p-4 text-red-700 mb-10",children:e.jsxs("div",{className:"flex gap-5",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Task Member Overview"}),e.jsxs("div",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ml-3 mt-2 ${d.status==="archived"?"bg-green-100 text-green-800 dark:bg-green-800/25 dark:text-green-400":d.status==="drop"?"bg-red-100 text-red-800 dark:bg-red-800/25 dark:text-red-400":"bg-yellow-100 text-yellow-800 dark:bg-yellow-800/25 dark:text-yellow-400"}`,children:[e.jsx(Te,{}),d.status]})]})}),e.jsx("div",{children:e.jsxs("button",{className:"text-gray-500 bg-gray-200 px-3 py-1 rounded-lg mt-6",onClick:()=>W(-1),children:[e.jsx(Se,{className:"inline rotate-180 text-gray-500 mr-3"}),"Go Back"]})})]}),e.jsxs("div",{className:"w-full max-w-full mx-auto p-10 bg-white dark:bg-gray-800 rounded-xl shadow-lg space-y-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-600 dark:text-white",children:d.staff_name}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:()=>v(!0),className:"flex items-center justify-center text-white bg-[var(--color-primary)] hover-effect dark:bg-red-800 focus:outline-non font-medium text-sm rounded-sm px-5 py-2.5",children:["New Meeting"," ",e.jsx(De,{className:"ml-2",size:15})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 text-sm text-gray-600 dark:text-gray-300",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"font-medium text-gray-700 dark:text-gray-100",children:[e.jsx(ze,{className:"inline mr-2",size:16})," Staff ID:"]})," ",d.staff_id]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-100",children:"Project:"})," ",d.projecttitle]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-100",children:"Milestone:"})," ",d.milestonetitle]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-100",children:"Task:"})," ",d.task_title]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-100",children:"Sub Task:"})," ",d.subtask_title]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-100",children:"Status:"})," ",d.status]}),d.start_date&&e.jsxs("div",{children:[e.jsxs("span",{className:"font-medium text-green-700 dark:text-gray-100",children:[e.jsx(Fe,{className:"inline mr-2",size:16})," Start Date:"]})," ",new Date(d.start_date).toLocaleDateString()]}),d.end_date&&e.jsxs("div",{children:[e.jsxs("span",{className:"font-medium text-red-700 dark:text-gray-100",children:[e.jsx(Me,{className:"inline mr-2",size:16})," End Date:"]})," ",new Date(d.end_date).toLocaleDateString()]}),e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-100",children:"Priority:"})," ",d.task_priority]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-100",children:"Assigned By:"})," ",d.handlername]}),e.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-100",children:"Duration:"})," ",d.task_duration?q(d.task_duration):"N/A"]})]}),e.jsx("div",{className:"text-sm text-gray-700 dark:text-gray-200 mt-4",children:e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Task Description:"}),e.jsx("br",{}),d.notes]})}),e.jsxs("div",{className:"flex flex-wrap justify-end gap-4 mt-6",children:[w?e.jsxs("button",{onClick:()=>M(!1),className:"bg-red-100 hover:bg-red-200 text-red-700 px-6 py-2 rounded flex items-center gap-2",children:[e.jsx(Pe,{size:18})," Check Out"]}):e.jsxs("button",{onClick:()=>M(!0),className:"bg-green-100 hover:bg-green-200 text-green-700 px-3 py-2 rounded flex items-center gap-2",children:[e.jsx(Ie,{size:18})," Check In"]}),e.jsxs("button",{onClick:()=>E(!f),className:`px-3 py-2 rounded flex items-center gap-2 ${f?"bg-gray-200 hover:bg-gray-300 text-gray-600":"bg-blue-100 hover:bg-blue-200 text-blue-800"}`,children:[e.jsx(Be,{size:18}),f?"Cancel Complete":"Mark as Completion"]})]}),f&&e.jsxs("div",{className:"space-y-4 mt-6",children:[e.jsx("h3",{className:"text-lg font-semibold border-b pb-2 text-gray-800 dark:text-gray-100 border-gray-200 dark:border-gray-700",children:"Task Completion Details"}),d.end_date&&new Date>new Date(d.end_date)?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-blue-100 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Delay Reason"}),e.jsxs("select",{value:A,required:!0,onChange:n=>L(n.target.value),className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",children:[e.jsx("option",{value:"member",children:"Member"}),e.jsx("option",{value:"client",children:"Client"})]})]}),e.jsxs("div",{className:"bg-blue-100 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700 ",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Reason for Delay"}),e.jsx("textarea",{value:P,onChange:n=>U(n.target.value),placeholder:"Explain the reason for delay",required:!0,className:"w-[50%] bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none min-h-[50px]"})]})]}):e.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:e.jsx("p",{className:"text-green-600 dark:text-green-400 text-sm font-medium",children:"Task is being completed on time."})}),e.jsx("div",{className:"flex justify-end gap-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:e.jsx("button",{onClick:V,className:"px-5 py-2 bg-red-700 hover:bg-red-800 dark:bg-red-800 dark:hover:bg-red-900 text-white rounded-md transition-colors duration-200 font-medium text-sm shadow-sm",children:"Confirm Completion"})})]})]}),e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:"w-[70%] max-w-[70%] mx-auto p-6 bg-white dark:bg-gray-800 rounded-xl shadow-lg mt-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-600 dark:text-white mb-4",children:"Time Entries"}),e.jsx(ue,{thead:p,tbody:Z}),e.jsx("div",{className:"mt-4",children:e.jsx(he,{total:$.length,currentPage:_,defaultPageSize:10,onChange:z,paginationLabel:"time entries"})})]}),e.jsxs("div",{className:"w-[25%] max-w-[25%] mx-auto p-6 bg-white dark:bg-gray-800 rounded-xl shadow-lg space-y-4 mt-6",children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-600 dark:text-white",children:"Project Activity"}),e.jsx("p",{className:"text-gray-500",children:"Task progress and comments"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:e.jsxs("select",{className:"w-full p-2 rounded-md border border-gray-300 bg-blue-200/25 dark:bg-gray-700 text-gray-600 dark:text-white focus:outline-none focus:border-gray-300",children:[e.jsx("option",{children:"In Progress"}),e.jsx("option",{children:"Completed"}),e.jsx("option",{children:"To Do"})]})}),e.jsx("div",{children:e.jsxs("select",{className:"w-full p-2 rounded-md bg-blue-200/25 dark:bg-gray-700 border border-gray-300 text-gray-800 dark:text-white focus:outline-none focus:border-gray-300",children:[e.jsx("option",{children:"10%"}),e.jsx("option",{children:"25%"}),e.jsx("option",{children:"50%"}),e.jsx("option",{children:"75%"}),e.jsx("option",{children:"100%"})]})})]}),e.jsxs("div",{className:"rounded-lg p-2 dark:bg-gray-700 space-y-4 h-auto",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-500 dark:text-gray-200",children:"Comments"}),e.jsx("textarea",{placeholder:"Post your comment",className:"w-full p-2 h-40 border mt-2 border-gray-200 rounded-md bg-gray-200 dark:bg-gray-600 text-gray-500 dark:text-white focus:outline-none focus:border-gray-200"})]}),e.jsx("button",{className:"w-full bg-red-700 hover:bg-red-800 text-white p-2 rounded-md focus:outline-none",children:"Submit"})]})]})]}),e.jsx(pe,{isVisible:g,className:"w-full md:w-[800px]",onClose:()=>v(!1),title:"Create Meeting",children:e.jsx(Ae,{memberData:d,onSuccess:G,onCancel:()=>v(!1)})})]}):e.jsx("div",{className:"p-4",children:"No member data found"})},kt=me(Le);export{kt as default};
