import{r as c,j as e}from"./chunk-AYJ5UCUI-nSEPIBkT.js";import{a as M,B}from"./api-C04JdqFc.js";import{V as A}from"./index-DxoBGdjx.js";import{B as L}from"./ButtonLoader-Z62NVHwI.js";import{u as F}from"./AuthStore-BnYeBJES.js";import{u as P,a as _}from"./ProjectStore-Bmk5yusB.js";import{u as U}from"./useBranchStore-kvv3vD_e.js";import{u as R}from"./useEmployeeStore-BJ_SZO4g.js";import{F as H}from"./flag-GJ94Fqe2.js";import{H as $}from"./hash-Cmnw3-GM.js";import{N as I}from"./network-4iL8t-Of.js";import{c as S}from"./createLucideIcon-RccWoOaL.js";import{C as V}from"./clipboard-list-C2ET-QCv.js";import{U as G}from"./user-round-DtkRnRSi.js";import{T as p}from"./tag-hjf6KM-t.js";import{C as w}from"./calendar-check-DuYbAMAv.js";import{U as C}from"./user-DKFoNGWn.js";import{L as J}from"./list-checks-Bum2w6xD.js";/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M12 3v3",key:"1n5kay"}],["path",{d:"M4 6a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1h13a2 2 0 0 0 1.152-.365l3.424-2.317a1 1 0 0 0 0-1.635l-3.424-2.318A2 2 0 0 0 17 6z",key:"1btarq"}]],Q=S("milestone",K);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],X=S("target",W),pe=({taskData:t,onSuccess:z,onCancel:T})=>{console.log("taskkidin tssk",t==null?void 0:t.id);const m=U(r=>r.branchCodeOptions),[b,h]=c.useState(!1),j=t.id,[Y,Z]=c.useState(!0),g=P(r=>r.clientscodeOptions),[k,x]=c.useState(null),u=_(r=>r.allProjectcodeOptions),o=R(r=>r.branchEmployeeOptions),y=_(r=>r.allMilestonecodeOptions),E=F(r=>r.accessToken),[a,f]=c.useState({branchcode:"",client_code:"",project_code:"",milestone_code:"",task_title:"",task_priority:"",start_date:"",end_date:"",handler_by:"",notes:"",collaborate:[],status:"draft"});c.useEffect(()=>{if(t){const r=t.start_date?t.start_date.split("T")[0]:"",d=t.end_date?t.end_date.split("T")[0]:"";f({branchcode:t.branchcode||"",client_code:t.client_code||"",project_code:t.project_code||"",milestone_code:t.milestone_code||"",task_title:t.task_title||"",task_priority:t.task_priority||"",start_date:r,end_date:d,handler_by:t.handler_by||"",notes:t.notes||"",collaborate:t.collaborate||[],status:t.status||"draft"})}},[t]);const s=r=>{const{name:d,value:n}=r.target;f(l=>({...l,[d]:n}))},q=async r=>{var n,l,v,N;r.preventDefault(),h(!0),x(null);const d={data:{branchcode:a.branchcode,client_code:a.client_code,project_code:a.project_code,milestone_code:a.milestone_code,task_title:a.task_title,task_priority:a.task_priority,start_date:a.start_date,end_date:a.end_date,handler_by:a.handler_by,notes:a.notes,status:a.status}};try{console.log("taskdataaaa",d,j);const i=await M.put(`${B}/project/task/edit/${j}`,d,{headers:{Authorization:`Bearer ${E}`}});i.status===200?z():x(i.data.message||"Failed to update task")}catch(i){x(((l=(n=i.response)==null?void 0:n.data)==null?void 0:l.message)||"An error occurred"),A.error(((N=(v=i.response)==null?void 0:v.data)==null?void 0:N.message)||"Error updating task")}finally{h(!1)}};return e.jsxs("div",{className:"flex flex-col gap-6 dark:bg-gray-800 bg-white p-6 rounded-lg",children:[k&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",children:k}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold border-b pb-2 text-gray-800 dark:text-gray-100 border-gray-200 dark:border-gray-700",children:[e.jsx(H,{className:"inline mr-2"})," Task Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx($,{className:"inline mr-1",size:14})," Branch Code"]}),e.jsxs("select",{name:"branchcode",value:a.branchcode,onChange:s,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",required:!0,children:[e.jsx("option",{value:"",children:"Select Branch"}),m==null?void 0:m.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(I,{className:"inline mr-1",size:14})," Related Project"]}),e.jsxs("select",{name:"project_code",value:a.project_code,onChange:s,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",required:!0,children:[e.jsx("option",{value:"",children:"Select Project"}),u==null?void 0:u.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(Q,{className:"inline mr-1",size:14})," Select Milestone"]}),e.jsxs("select",{name:"milestone_code",value:a.milestone_code,onChange:s,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",required:!0,children:[e.jsx("option",{value:"",children:"Select Milestone"}),y==null?void 0:y.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(V,{className:"inline mr-1",size:14})," Task Title"]}),e.jsx("input",{name:"task_title",value:a.task_title,onChange:s,type:"text",className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",placeholder:"Enter task name",required:!0})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(G,{className:"inline mr-1",size:14})," Select Client"]}),e.jsxs("select",{name:"client_code",value:a.client_code,onChange:s,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",children:[e.jsx("option",{value:"",children:"Select Client"}),g==null?void 0:g.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(p,{className:"inline mr-1",size:14})," Task Priority"]}),e.jsxs("select",{name:"task_priority",value:a.task_priority,onChange:s,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",required:!0,children:[e.jsx("option",{value:"",children:"Select Priority"}),e.jsx("option",{value:"minor",children:"Minor"}),e.jsx("option",{value:"major",children:"Major"}),e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"blocker",children:"Blocker"})]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(w,{className:"inline mr-1",size:14})," Start Date"]}),e.jsx("input",{name:"start_date",value:a.start_date,onChange:s,type:"date",className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",required:!0})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(w,{className:"inline mr-1",size:14})," Due Date"]}),e.jsx("input",{name:"end_date",value:a.end_date,onChange:s,type:"date",className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",required:!0})]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(C,{className:"inline mr-1",size:14})," Handle By"]}),e.jsxs("select",{name:"handler_by",value:a.handler_by,onChange:s,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",required:!0,children:[e.jsx("option",{value:"",children:"Select Handler"}),o==null?void 0:o.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(p,{className:"inline mr-1",size:14})," Status"]}),e.jsxs("select",{name:"status",value:a.status,onChange:s,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",required:!0,children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"paused",children:"Paused"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"archived",children:"Archived"})]})]})]}),a.collaborate.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold border-b pb-2 text-gray-800 dark:text-gray-100 border-gray-200 dark:border-gray-700",children:"Collaborators (Read Only)"}),a.collaborate.map((r,d)=>{var n;return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(C,{className:"inline mr-1",size:14})," Staff Member"]}),e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mt-1",children:((n=o==null?void 0:o.find(l=>l.value===r.staff_id))==null?void 0:n.label)||r.staff_id})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(p,{className:"inline mr-1",size:14})," Collaboration Status"]}),e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 capitalize",children:r.status})]})]},d)})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold border-b pb-2 text-gray-800 dark:text-gray-100 border-gray-200 dark:border-gray-700",children:[e.jsx(J,{className:"inline mr-2"})," Notes"]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2",children:[e.jsx(X,{className:"inline mr-1",size:14})," Task Notes"]}),e.jsx("textarea",{name:"notes",value:a.notes,onChange:s,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 focus:outline-none min-h-[100px]",placeholder:"Enter the Task Notes"})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("button",{type:"button",className:"px-5 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 rounded-md transition-colors duration-200 font-medium text-sm",onClick:T,children:"Cancel"}),e.jsx("button",{type:"submit",onClick:q,disabled:b,className:"px-5 py-2 bg-red-700 hover:bg-red-800 dark:bg-red-800 dark:hover:bg-red-900 text-white rounded-md transition-colors duration-200 font-medium text-sm shadow-sm disabled:opacity-70",children:b?e.jsx(L,{}):"Update Task"})]})]})};export{pe as E,Q as M,X as T};
