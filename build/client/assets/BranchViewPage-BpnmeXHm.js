import{w as Oe}from"./with-props-DF0D9zIo.js";import{r as t,j as e,u as Pe,c as Re}from"./chunk-AYJ5UCUI-nSEPIBkT.js";import{D as Te}from"./DataTable-DtyPIAGZ.js";import{C as _e}from"./CustomPagination-CBTcVvJz.js";import{S as Ie}from"./SearchInput-CMdOUuSO.js";import{M as $}from"./Modal-BCIUwH-b.js";import{D as R}from"./DrapDown-CEm3nLdF.js";import{F as Ve,u as T,w as qe}from"./xlsx-DTxMWUdD.js";import{t as ae,a as _,B as I}from"./api-C04JdqFc.js";import{O as te,V as b}from"./index-DxoBGdjx.js";import{B as re}from"./ButtonLoader-Z62NVHwI.js";import{u as se}from"./AuthStore-BnYeBJES.js";import{u as Ge}from"./useBranchStore-kvv3vD_e.js";import{u as Y}from"./useEmployeeStore-BJ_SZO4g.js";import{a as Ue,E as He}from"./EditFormData-Bo3BQ7HJ.js";import{u as Ke}from"./use-click-outside-BhLpsQYS.js";import{B as Qe}from"./BranchMeetingForm-DfT3S_5L.js";import{C as Z}from"./clipboard-list-C2ET-QCv.js";import{F as ee}from"./file-text-BNGbNc3I.js";import{L as Je}from"./log-out-DAuSHV9-.js";import{M as We}from"./message-square-text-D3my64cM.js";import{S as Xe}from"./square-pen-hueQTsQ_.js";import{T as Ye}from"./trash-2-AUNIB88j.js";import"./index-knF4tUPh.js";/* empty css            */import"./index-DDa5wjlm.js";import"./iconBase-CajCgYY2.js";import"./createLucideIcon-RccWoOaL.js";import"./react-_sXfQCJm.js";/* empty css                         */import"./moment-C5S46NFB.js";import"./network-4iL8t-Of.js";import"./hash-Cmnw3-GM.js";import"./calendar-check-DuYbAMAv.js";import"./map-pin-DetA7opX.js";import"./phone-iHDF8fYQ.js";import"./user-round-DtkRnRSi.js";import"./user-DKFoNGWn.js";import"./video-BzePKQuD.js";import"./file-QxKA-9Fo.js";import"./calendar-C_LRGMui.js";import"./clock-CzOQJT5p.js";import"./users-CXAhoVGa.js";import"./x-BfrbTbzo.js";import"./chevron-up-DjUqBI0v.js";import"./chevron-down-DOBgonSl.js";import"./plus-HifIQSWH.js";const Ze=({branch:r,onSuccess:y,onCancel:D})=>{console.log("roleeebranchhc",r);const[u,i]=t.useState(!1),[V,F]=t.useState(null),j=se(l=>l.accessToken),A=Y(l=>l.allEmployeecodeOptions);console.log("employeeopionsmnagerr",A);const{fetchEmployee:v,fetchBranchEmployee:q,isStoreLoading:N}=Y(),s=r[0];console.log("branchdataaa",s);const[o,x]=t.useState({branch_hours:s.branch_hours,branchcode:s.branchcode,name:s.name,location:s.location,mobile:s.mobile,email:s.email,manager_id:s.manager_id,managername:s.managername,notes:s.notes,role:"",status:"active",closeReason:""}),h=l=>{const{name:p,value:f}=l.target;x(n=>({...n,[p]:f}))};t.useEffect(()=>{v(j)},[j]);const z=async l=>{var p,f;l.preventDefault(),i(!0);try{const n=await _.post(`${I}/branch/create`,o,{headers:{Authorization:`Bearer ${j}`}});n.status===201?y():F(n.data.message||"Failed to create branch")}catch(n){F(((f=(p=n.response)==null?void 0:p.data)==null?void 0:f.message)||"An error occurred"),b.error(`${V}, Error in create Branch`,{style:{border:"1px solid rgb(185 28 28)",padding:"14px",width:"900px",color:"rgb(185 28 28)"},iconTheme:{primary:"rgb(185 28 28)",secondary:"#FFFAEE"}})}finally{i(!1)}};return e.jsxs("div",{className:"flex flex-col gap-6 dark:bg-gray-800 bg-white p-6 rounded-lg",children:[e.jsx(te,{position:ae}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold border-b pb-2 text-gray-800 dark:text-gray-100 border-gray-200 dark:border-gray-700",children:[e.jsx(Ue,{className:"inline mr-2"}),"   Additional Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(Z,{className:"inline mr-1",size:14})," Status"]}),e.jsxs("select",{name:"status",value:o.status,onChange:h,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",required:!0,children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inActive",children:"Inactive"})]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:[e.jsx(Z,{className:"inline mr-1",size:14})," Role ",e.jsx("span",{className:"text-red-700 text-lg m-2",children:"*"})]}),e.jsx("input",{name:"role",value:o.role,onChange:h,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 mt-1 focus:outline-none",type:"text",placeholder:"Role",required:!0})]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2",children:[e.jsx(ee,{className:"inline mr-1",size:14})," Notes"]}),e.jsx("textarea",{name:"notes",value:o.notes,onChange:h,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 focus:outline-none min-h-[100px]",placeholder:"Branch notes...",required:!0})]}),o.status==="inActive"&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/70 p-4 rounded-lg border border-gray-100 dark:border-gray-700",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2",children:[e.jsx(ee,{className:"inline mr-1",size:14})," Close Reason"]}),e.jsx("textarea",{name:"closeReason",value:o.closeReason,onChange:h,className:"w-full bg-transparent text-sm font-medium text-gray-900 dark:text-gray-100 focus:outline-none min-h-[60px]",placeholder:"Closing reason...",required:!0})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("button",{type:"button",className:"px-5 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 rounded-md transition-colors duration-200 font-medium text-sm",onClick:D,disabled:u,children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-5 py-2 bg-red-700 hover:bg-red-800 dark:bg-red-700 dark:hover:bg-red-800 text-white rounded-md transition-colors duration-200 font-medium text-sm shadow-sm",onClick:z,disabled:u,children:u?e.jsx(re,{}):"Create Branch"})]})]})},ea=()=>{const r=Ke({query:"(max-width: 768px)"}),[y,D]=t.useState(""),[u,i]=t.useState(1),[V,F]=t.useState(""),[j,A]=t.useState([]),[v,q]=t.useState(""),[N,s]=t.useState([]),[o,x]=t.useState(!1),[h,z]=t.useState(0),[l,p]=t.useState(null),[f,n]=t.useState(!1),[oe,S]=t.useState(!1),[G,ne]=t.useState(),[le,k]=t.useState(!1),[ce,ie]=t.useState(""),[L,de]=t.useState(""),[O,me]=t.useState(""),[U,aa]=t.useState(""),[C,ue]=t.useState(8),[P,ge]=t.useState(!1),g=se(a=>a.accessToken),[xe,B]=t.useState(!1),he=Pe(),{branches:ta,managerOptions:pe,branchCodeOptions:ra,fetchBranches:E,isLoading:fe}=Ge(),{id:H}=Re();console.log("useparammss",H);const be=[{value:"",label:"All Branches"},{value:"active",label:"Active Branches"},{value:"inactive",label:"Inactive Branches"}],ye=[{value:20,label:"20 per page"},{value:40,label:"30 per page"},{value:50,label:"40 per page"},{value:80,label:"50 per page"},{value:100,label:"100 per page"},{value:200,label:"100 per page"}];t.useEffect(()=>{E(g)},[g]);const M=async(a=u,w=C,d=y,K=v,Q=O,J=U,W=L)=>{var X;x(!0);try{let m=`${I}/branch/read?branchcode=${H}&page=${a}&limit=${w}`;d&&(m+=`&search=${d}`),K&&(m+=`&status=${K}`),Q&&(m+=`&manager_id=${Q}`),J&&(m+=`&branchcode=${J}`),W&&(m+=`&dec=${W}`);const c=await _.get(m,{headers:{Authorization:`Bearer ${g}`}});console.log("responseeebranch",c),A(c==null?void 0:c.data),z(((X=c==null?void 0:c.data)==null?void 0:X.length)||0),s((c==null?void 0:c.data)||[])}catch(m){console.error("Error fetching branch list",m),p("Failed to fetch branches")}finally{x(!1)}};t.useEffect(()=>{M()},[u,y,v,O,U,L,C]);const je=a=>{i(a)},ve=()=>{n(!1),b.success("Branch added successfully!"),E(g),M()},we=a=>{D(a),i(1)},Ne=a=>{ne(a),S(!0)},Se=a=>{k(!0),ie(a)},ke=async()=>{const a=Number(ce),w={userId:"GK123"};try{x(!0);const d=await _.delete(`${I}/branch/delete/${a}`,{data:w,headers:{Authorization:`Bearer ${g}`}});(d==null?void 0:d.status)===201&&(k(!1),b.success("Branch deleted successfully!"),E(g),M())}catch(d){console.error("Error deleting branch",d),b.error("Failed to delete branch")}finally{x(!1)}},Ce=()=>{de(a=>a==="desc"?"":"desc"),i(1)},Be=a=>{q(a),i(1)},Ee=a=>{me(a),i(1)},Me=a=>{ue(a),i(1)},$e=()=>[{data:"id"},{data:"Branch Code"},{data:"name"},{data:"Location"},{data:"Mobile"},{data:"Manager ID"},{data:"Status"},{data:"Actions",className:"text-center"}],De=()=>N?N.map(a=>({id:a.id,data:[{data:a.id},{data:a.branchcode},{data:a.name},{data:a.location},{data:a.mobile},{data:a.manager_id},{data:e.jsxs("div",{className:`px-3 py-1 rounded-full text-sm inline-flex items-center ${a.status==="active"?"bg-green-100 text-green-800 dark:bg-green-800/25 dark:text-green-400":"bg-red-100 text-red-800 dark:bg-red-800/25 dark:text-red-300"}`,children:[e.jsx("span",{className:`w-2 h-2 rounded-full mr-2 ${a.status==="active"?"bg-green-800 dark:bg-green-400":" bg:text-red-300 bg-red-800"}`}),a.status.charAt(0).toUpperCase()+a.status.slice(1)]})},{data:e.jsxs("div",{className:"flex flex-wrap justify-center gap-2",children:[e.jsx("button",{className:"p-1 text-[var(--color-primary)] rounded hover:text-gray-500 dark:hover:text-gray-300",onClick:()=>Ne(a),title:"Edit",children:e.jsx(Xe,{size:18})}),e.jsx("button",{className:"p-1 text-red-600 rounded hover:text-gray-500 dark:hover:text-gray-300",onClick:()=>Se(a.id),title:"Delete",children:e.jsx(Ye,{size:18})})]}),className:"action-cell"}]})):[],Fe=()=>{B(!1),b.success("Meeting and Document Created successfully!")},Ae=()=>{S(!1),b.success("Branch updated successfully!"),E(g),M()},ze=()=>{const a=T.book_new(),w=T.json_to_sheet(j);T.book_append_sheet(a,w,"Branches"),qe(a,"BranchList.xlsx")},Le=()=>{he(-1)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col min-h-screen",children:[e.jsxs("div",{className:"p-4 flex-grow",children:[e.jsxs("div",{className:"flex justify-between items-center mb-5",children:[e.jsx("h2",{className:"text-xl font-semibold text-[var(--color-primary)] dark:text-[var(--color-primary)]",children:"Branch Role Management"}),e.jsx("div",{children:e.jsxs("button",{className:"text-gray-500 bg-gray-200 px-3 py-1 rounded-lg mt-6",onClick:Le,children:[e.jsx(Je,{className:"inline rotate-180 text-gray-500 mr-3"}),"Go Back"]})}),r&&e.jsx("button",{onClick:()=>ge(!P),className:"p-2 bg-gray-200 rounded-md",children:P?"Hide Filters":"Show Filters"})]}),e.jsx(te,{position:ae,reverseOrder:!1}),e.jsx("div",{className:`flex ${r?"flex-col":"items-end justify-end"} gap-4 mb-5`,children:e.jsxs("div",{className:`flex ${r?"flex-col":"flex-row"} gap-4`,children:[e.jsx(R,{options:ye,selectedValue:C,onSelect:Me,placeholder:"Items per page",className:"w-full md:w-[150px]"}),e.jsxs("button",{onClick:ze,className:"flex items-center justify-center text-gray-400 bg-white focus:outline-non font-medium text-sm rounded-sm border border-dotted border-gray-400 hover:text-red-700/70 px-3 dark:bg-gray-800 dark:text-gray-300 py-2.5",children:[e.jsx(Ve,{className:"mr-1"}),!r&&"Export Excel"]}),e.jsxs("button",{onClick:()=>n(!0),className:"flex items-center justify-center text-white bg-[var(--color-primary)] hover-effect dark:bg-red-800 focus:outline-non font-medium text-sm rounded-sm px-5 py-2.5",children:[!r&&"New Role"," +"]}),e.jsxs("button",{onClick:()=>B(!0),className:"flex items-center justify-center text-white bg-[var(--color-primary)] hover-effect dark:bg-red-800 focus:outline-non font-medium text-sm rounded-sm px-5 py-2.5",children:[!r&&"New Meeting"," ",e.jsx(We,{className:"ml-2",size:15})]})]})}),e.jsx("div",{className:`${r&&!P?"hidden":"block"} mb-4`,children:e.jsxs("div",{className:`${r?"grid grid-cols-1 gap-3":"flex flex-wrap justify-between items-center gap-3"}`,children:[e.jsx(R,{options:be,selectedValue:v,onSelect:Be,placeholder:"Branch Status",className:"w-full md:w-[200px]"}),e.jsx(R,{options:pe,selectedValue:O,onSelect:Ee,placeholder:"Manager",className:"w-full md:w-[200px]",isLoading:fe}),e.jsxs("button",{onClick:Ce,className:`${r?"w-full":"w-[200px]"} h-[40px] text-white bg-[var(--color-primary)] hover-effect px-2 py-1 rounded-sm`,children:["Sort ",L==="desc"?"↑":"↓"]}),e.jsx("div",{className:`${r?"w-full":"w-[200px] mt-3"}`,children:e.jsx(Ie,{value:y,onChange:we,placeholder:"Search branches...",className:"w-full"})})]})}),o&&e.jsx("div",{className:"text-center py-4",children:"Loading..."}),l&&e.jsx("div",{className:"text-red-500 text-center py-4",children:l}),e.jsx("div",{className:"overflow-x-auto",children:e.jsx(Te,{thead:$e,tbody:De,responsive:!0,className:"min-w-full"})})]}),e.jsx("div",{className:"bottom-0 border-t border-gray-200 dark:border-gray-700 p-4",children:e.jsx(_e,{total:h,currentPage:u,defaultPageSize:C,onChange:je,paginationLabel:"branches",isScroll:!0})})]}),e.jsx($,{isVisible:f,className:"w-full md:w-[800px]",onClose:()=>n(!1),title:"Create New Role",children:e.jsx(Ze,{branch:N,onSuccess:ve,onCancel:()=>n(!1)})}),e.jsx($,{isVisible:oe,className:"w-full md:w-[800px]",onClose:()=>S(!1),title:"Edit Branch",children:e.jsx(He,{branch:G,onSuccess:Ae,onCancel:()=>S(!1)})}),e.jsx($,{isVisible:xe,className:"w-full md:w-[800px]",onClose:()=>B(!1),title:"Create Branch Meeting",children:e.jsx(Qe,{branch:G,onSuccess:Fe,onCancel:()=>B(!1)})}),e.jsx($,{isVisible:le,className:"w-full md:w-[600px]",onClose:()=>k(!1),title:"Delete Branch",children:e.jsxs("div",{className:"flex flex-col gap-6 dark:bg-gray-800 bg-white p-6 rounded-lg",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-100",children:"Confirm Deletion"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Are you sure you want to delete this branch? This action cannot be undone."})]}),e.jsxs("div",{className:"flex justify-center gap-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("button",{type:"button",className:"px-5 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 rounded-md transition-colors duration-200 font-medium text-sm",onClick:()=>k(!1),disabled:o,children:"Cancel"}),e.jsx("button",{type:"button",className:"px-5 py-2 bg-red-700 hover:bg-red-800 dark:bg-red-700 dark:hover:bg-red-800 text-white rounded-md transition-colors duration-200 font-medium text-sm shadow-sm",onClick:ke,disabled:o,children:o?e.jsx(re,{}):"Delete Branhch"})]})]})})]})},Xa=Oe(ea);export{Xa as default};
